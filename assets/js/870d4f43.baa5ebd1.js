"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([[8113],{8818:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>t,contentTitle:()=>c,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>a});var n=s(5893),o=s(1151);const i={sidebar_position:7},c=void 0,l={id:"devops/Cr\xe9ez un registre docker priv\xe9 et un docker hub proxy avec Nexus",title:"Cr\xe9ez un registre docker priv\xe9 et un docker hub proxy avec Nexus",description:"Au lieu de stocker nos images Docker priv\xe9es g\xe9n\xe9r\xe9es lors des builds sur un registry public tel que Docker Hub, nous allons mettre en place un registry priv\xe9 avec Nexus (docker hosted). Nous allons \xe9galement en profiter pour cr\xe9er un proxy vers le Docker Hub public (docker proxy). Un d\xe9p\xf4t proxy Docker dans Nexus agit comme un interm\xe9diaire entre notre environnement de d\xe9veloppement (ou CI/CD) et Docker Hub. Nexus stocke localement les images Docker provenant de Docker Hub, r\xe9duisant ainsi le temps de t\xe9l\xe9chargement en cas de demandes r\xe9p\xe9t\xe9es et permet aux d\xe9veloppeurs d'acc\xe9der plus rapidement aux d\xe9pendances n\xe9cessaires \xe0 leurs projets.",source:"@site/docs/devops/Cr\xe9ez un registre docker priv\xe9 et un docker hub proxy avec Nexus.md",sourceDirName:"devops",slug:"/devops/Cr\xe9ez un registre docker priv\xe9 et un docker hub proxy avec Nexus",permalink:"/docs/devops/Cr\xe9ez un registre docker priv\xe9 et un docker hub proxy avec Nexus",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:7,frontMatter:{sidebar_position:7},sidebar:"tutorialSidebar",previous:{title:"Conteneurisez l'application Spring Boot avec Docker",permalink:"/docs/devops/Conteneurisez l'application Spring Boot avec Docker"},next:{title:"Utilisez Ansible pour automatiser le d\xe9ploiement de votre application",permalink:"/docs/devops/Utilisez Ansible pour automatiser le d\xe9ploiement de votre application"}},t={},a=[{value:"Installez Nexus Repository Manager",id:"installez-nexus-repository-manager",level:2},{value:"Configurez docker pour accepter les registres non s\xe9curis\xe9s",id:"configurez-docker-pour-accepter-les-registres-non-s\xe9curis\xe9s",level:2},{value:"Cr\xe9ez un docker hub proxy",id:"cr\xe9ez-un-docker-hub-proxy",level:2},{value:"Cr\xe9ez un stockage blob pour le registre priv\xe9",id:"cr\xe9ez-un-stockage-blob-pour-le-registre-priv\xe9",level:3},{value:"Activez &quot;Docker Bearer Token Relam&quot;",id:"activez-docker-bearer-token-relam",level:3},{value:"Cr\xe9ez un registre docker hub proxy",id:"cr\xe9ez-un-registre-docker-hub-proxy",level:3},{value:"Cr\xe9ez un registre docker priv\xe9",id:"cr\xe9ez-un-registre-docker-priv\xe9",level:2},{value:"Cr\xe9ez un stockage blob pour le registre priv\xe9",id:"cr\xe9ez-un-stockage-blob-pour-le-registre-priv\xe9-1",level:3},{value:"Cr\xe9ez un registre priv\xe9 (docker-hosted)",id:"cr\xe9ez-un-registre-priv\xe9-docker-hosted",level:3}];function d(e){const r={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.p,{children:"Au lieu de stocker nos images Docker priv\xe9es g\xe9n\xe9r\xe9es lors des builds sur un registry public tel que Docker Hub, nous allons mettre en place un registry priv\xe9 avec Nexus (docker hosted). Nous allons \xe9galement en profiter pour cr\xe9er un proxy vers le Docker Hub public (docker proxy). Un d\xe9p\xf4t proxy Docker dans Nexus agit comme un interm\xe9diaire entre notre environnement de d\xe9veloppement (ou CI/CD) et Docker Hub. Nexus stocke localement les images Docker provenant de Docker Hub, r\xe9duisant ainsi le temps de t\xe9l\xe9chargement en cas de demandes r\xe9p\xe9t\xe9es et permet aux d\xe9veloppeurs d'acc\xe9der plus rapidement aux d\xe9pendances n\xe9cessaires \xe0 leurs projets."}),"\n",(0,n.jsx)(r.p,{children:"Nous mettons donc en place deux registres avec Nexus :"}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsx)(r.li,{children:"Un registre d'images Docker priv\xe9"}),"\n",(0,n.jsx)(r.li,{children:"Un registre Docker public pour acc\xe9l\xe9rer les pulls"}),"\n"]}),"\n",(0,n.jsx)(r.p,{children:"Voici le principe de fonctionnement expliqu\xe9 avec le diagramme ci-dessous :"}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"concept.drawio",src:s(5592).Z+"",width:"491",height:"409"})}),"\n",(0,n.jsx)(r.h2,{id:"installez-nexus-repository-manager",children:"Installez Nexus Repository Manager"}),"\n",(0,n.jsxs)(r.p,{children:["Nous allons installer Nexus dans un conteneur Docker avec ",(0,n.jsx)(r.code,{children:"Docker compose"})," dans la VM ",(0,n.jsx)(r.code,{children:"masterserver"})]}),"\n",(0,n.jsx)(r.p,{children:"Le Docker Compose est un fichier YAML, contrairement au Dockerfile. Il permet de d\xe9crire l'ensemble de la configuration de l'application, les relations entre les images Docker, ainsi que l'ordre de d\xe9marrage de ces derni\xe8res."}),"\n",(0,n.jsxs)(r.p,{children:["Cr\xe9ez un fichier docker-compose.yaml dans votre espace de travail sur la machine h\xf4te ou directement sur ",(0,n.jsx)(r.code,{children:"masterserver"}),". Si vous souhaitez cr\xe9er le fichier sur votre machine h\xf4te, tout comme avec Docker CLI, installez Docker Compose."]}),"\n",(0,n.jsx)(r.p,{children:"Sur Windows, vous pouvez l'installer avec Chocolatey"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"choco install docker-compose\n"})}),"\n",(0,n.jsx)(r.p,{children:"Voici le contenu du fichier Docker Compose :"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-yaml",children:'version: "3.7"\r\nservices:\r\n  nexus:\r\n    image: sonatype/nexus3\r\n    expose:\r\n      - 8081\r\n      - 8082\r\n      - 8083\r\n    restart: always\r\n    volumes:\r\n      - "nexus-work:/sonatype-work"\r\n    ports:\r\n      - "5001:8081"\r\n      - "5002:8082"\r\n      - "5003:8083"\r\nvolumes:\r\n  nexus-work: {}\n'})}),"\n",(0,n.jsx)(r.p,{children:"Les ports expos\xe9s sont les suivants :"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"8081 : le port par d\xe9faut de Nexus pour acc\xe9der \xe0 son interface graphique."}),"\n",(0,n.jsx)(r.li,{children:"8082 : le port que nous allons choisir pour le registre public."}),"\n",(0,n.jsx)(r.li,{children:"8083 : le port que nous allons choisir pour le registre priv\xe9."}),"\n"]}),"\n",(0,n.jsxs)(r.p,{children:["Ces ports du conteneur (8081, 8082 et 8083) sont mapp\xe9s sur les ports 5001, 5002 et 5003 de la machine h\xf4te (",(0,n.jsx)(r.code,{children:"masterserver"}),"), respectivement. Vous \xeates libre de choisir d'autres ports en fonction de leur disponibilit\xe9 et de vos pr\xe9f\xe9rences !"]}),"\n",(0,n.jsx)(r.p,{children:'Le volume "nexus-work" est mont\xe9 sur le chemin "/sonatype-work" \xe0 l\'int\xe9rieur du conteneur. Cela permet de persister les donn\xe9es g\xe9n\xe9r\xe9es par Nexus, comme les artefacts et la configuration.'}),"\n",(0,n.jsx)(r.p,{children:"Placez-vous \xe0 la racine du dossier o\xf9 vous avez cr\xe9\xe9 votre fichier Docker Compose et ex\xe9cutez la commande suivante :"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{children:"docker compose up -d\n"})}),"\n",(0,n.jsxs)(r.p,{children:["Faites un ",(0,n.jsx)(r.code,{children:"docker ps"})," pour v\xe9rifier que le conteneur est en cours d'ex\xe9cution et que les ports sont correctement mapp\xe9s :"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{children:'E:\\workspace\\dockerize\\sonatype-nexus\r\n\u03bb docker ps\r\nCONTAINER ID   IMAGE                             COMMAND                  CREATED       STATUS      PORTS\r\n               NAMES\r\nbbe83eb3d218   sonatype/nexus3                   "/opt/sonatype/nexus\u2026"   6 days ago    Up 5 days   0.0.0.0:5001->8081/tcp, :::5001->8081/tcp, 0.0.0.0:5002->8082/tcp, :::5002->8082/tcp, 0.0.0.0:5003->8083/tcp, :::5003->8083/tcp   sonatype-nexus-nexus-1\n'})}),"\n",(0,n.jsxs)(r.p,{children:["Acc\xe9dez \xe0 l'interface web de Nexus depuis votre navigateur via l'adresse ",(0,n.jsx)(r.code,{children:"prod.local:5001"}),"."]}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"image-20240106125224705",src:s(5919).Z+"",width:"977",height:"561"})}),"\n",(0,n.jsxs)(r.p,{children:['Cliquez sur "Sign in" pour vous authentifier. Le compte administrateur est cr\xe9\xe9 automatiquement. Le nom d\'utilisateur est ',(0,n.jsx)(r.code,{children:"admin"})," et le mot de passe se trouve dans le fichier ",(0,n.jsx)(r.code,{children:"/nexus-data/admin.password"}),"."]}),"\n",(0,n.jsxs)(r.p,{children:["Pour l'afficher tapez cette commande dans ",(0,n.jsx)(r.code,{children:"masterserver"})," qui permet d'ex\xe9cuter la commande cat \xe0 l'int\xe9rieur du conteneur nexus:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"docker exec -i sonatype-nexus-nexus-1 cat /nexus-data/admin.password\n"})}),"\n",(0,n.jsx)(r.h2,{id:"configurez-docker-pour-accepter-les-registres-non-s\xe9curis\xe9s",children:"Configurez docker pour accepter les registres non s\xe9curis\xe9s"}),"\n",(0,n.jsxs)(r.p,{children:["Par d\xe9faut, Docker n'accepte pas la communication avec des registres non s\xe9curis\xe9s, c'est-\xe0-dire via HTTP. Cependant, notre domaine local ",(0,n.jsx)(r.code,{children:"prod.local"})," utilise uniquement le protocole HTTP. Par cons\xe9quent, nous devons configurer Docker pour lui permettre de communiquer avec des registres non s\xe9curis\xe9s."]}),"\n",(0,n.jsxs)(r.p,{children:["Nous allons cr\xe9er deux registres : le registre public, qui utilise le port ",(0,n.jsx)(r.code,{children:"5002"})," de notre machine h\xf4te, et le registre priv\xe9, qui utilise le port ",(0,n.jsx)(r.code,{children:"5003"}),"."]}),"\n",(0,n.jsx)(r.p,{children:"Vous allez donc ajouter l'adresse de ces deux registres \xe0 la liste des \"insecure-registries\" dans la configuration de Docker. Cela informe Docker qu'il peut se connecter \xe0 ces registres sans utiliser HTTPS."}),"\n",(0,n.jsxs)(r.p,{children:["La liste des registres non s\xe9curis\xe9s peut \xeatre ajout\xe9e sous format JSON dans le fichier ",(0,n.jsx)(r.code,{children:"/etc/docker/daemon.json"})," :"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:'root@masterserver:/# cat /etc/docker/daemon.json\r\n{\r\n  "insecure-registries" : ["http://prod.local:5002","http://prod.local:5003"]\r\n}\n'})}),"\n",(0,n.jsx)(r.p,{children:"Enregistrez le fichier et red\xe9marrez le service docker"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"sudo systemctl daemon-reload\r\nsudo systemctl restart docker\n"})}),"\n",(0,n.jsx)(r.p,{children:'Petite information : pour vos propres serveurs et si vous avez un vrai nom de domaine enregistr\xe9, vous pouvez utiliser "Let\'s Encrypt" pour obtenir des certificat SSL/TLS gratuit !'}),"\n",(0,n.jsx)(r.h2,{id:"cr\xe9ez-un-docker-hub-proxy",children:"Cr\xe9ez un docker hub proxy"}),"\n",(0,n.jsx)(r.h3,{id:"cr\xe9ez-un-stockage-blob-pour-le-registre-priv\xe9",children:"Cr\xe9ez un stockage blob pour le registre priv\xe9"}),"\n",(0,n.jsx)(r.p,{children:"Le stockage blob permet de stocker les images docker."}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsx)(r.p,{children:"Cliquez sur l'ic\xf4ne de configuration (engrenage)."}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsx)(r.p,{children:'Acc\xe9dez \xe0 "Blob Stores".'}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsx)(r.p,{children:'Cr\xe9ez un nouveau Blob Store de type "File".'}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsx)(r.p,{children:'Vous pouvez lui donner le nom de votre choix, mais un bon choix est "docker-hub".'}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsx)(r.p,{children:'Cliquez sur "Save".'}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"image-20240106174647326",src:s(3938).Z+"",width:"513",height:"704"})}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(r.h3,{id:"activez-docker-bearer-token-relam",children:'Activez "Docker Bearer Token Relam"'}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.code,{children:"Docker Bearer Token Realm"})," est une mesure de s\xe9curit\xe9 n\xe9cessaire pour g\xe9rer l'authentification des pulls anonymes."]}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsx)(r.p,{children:'Cliquez sur "Security > Realms".'}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsx)(r.p,{children:'Ajoutez le "Docker Bearer Token Realm".'}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsx)(r.p,{children:'Cliquez sur "Save".'}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"image-20240106221518161",src:s(6104).Z+"",width:"1091",height:"580"})}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(r.h3,{id:"cr\xe9ez-un-registre-docker-hub-proxy",children:"Cr\xe9ez un registre docker hub proxy"}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsx)(r.li,{children:'Cliquez sur "Repositories".'}),"\n",(0,n.jsx)(r.li,{children:'Cliquez sur "Create Repository" et s\xe9lectionnez "docker (proxy)".'}),"\n",(0,n.jsx)(r.li,{children:'Donnez-lui un nom, exemple "docker-hub"'}),"\n",(0,n.jsx)(r.li,{children:'Cochez "HTTP" et attribuez-lui le port 8082 (c\'est le port que nous avons choisi pour le registre public).'}),"\n",(0,n.jsx)(r.li,{children:'Cochez "Allow anonymous docker pull".'}),"\n",(0,n.jsxs)(r.li,{children:["Sous Proxy > Remote Storage, saisissez cette URL : ",(0,n.jsx)(r.a,{href:"https://registry-1.docker.io/",children:"https://registry-1.docker.io"})]}),"\n",(0,n.jsx)(r.li,{children:'Sous Docker Index, s\xe9lectionnez "Use Docker Hub".'}),"\n",(0,n.jsx)(r.li,{children:'Sous Storage > Blob Store, choisissez le Blob Store que vous avez cr\xe9\xe9 pr\xe9c\xe9demment ("docker-hub").'}),"\n",(0,n.jsx)(r.li,{children:'Cliquez sur "Create Repository".'}),"\n"]}),"\n",(0,n.jsx)(r.p,{children:"Voil\xe0, vous avez cr\xe9\xe9 un registre docker hub de type proxy !"}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"image-20240106221918648",src:s(835).Z+"",width:"1287",height:"209"})}),"\n",(0,n.jsx)(r.p,{children:"Maintenant, il est temps de tester tout cela. Vous allez donc tester un pull d'une image docker depuis le docker hub proxy :"}),"\n",(0,n.jsxs)(r.p,{children:["Avec Docker Hub, si vous souhaitez r\xe9cup\xe9rer une image du serveur ",(0,n.jsx)(r.code,{children:"nginx"}),", par exemple, vous pouvez le faire avec la commande ",(0,n.jsx)(r.code,{children:"docker pull nginx"}),". Maintenant, pour passer par le proxy Docker Hub que vous avez cr\xe9\xe9, lancez la commande ",(0,n.jsx)(r.code,{children:"docker pull prod.local:5002/nginx"})," dans votre terminal :"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{children:"root@masterserver:/home/mossaabfr# docker pull prod.local:5002/nginx\r\nUsing default tag: latest\r\nlatest: Pulling from nginx\r\naf107e978371: Pull complete\r\n336ba1f05c3e: Pull complete\r\n8c37d2ff6efa: Pull complete\r\n51d6357098de: Pull complete\r\n782f1ecce57d: Pull complete\r\n5e99d351b073: Pull complete\r\n7b73345df136: Pull complete\r\nDigest: sha256:2bdc49f2f8ae8d8dc50ed00f2ee56d00385c6f8bc8a8b320d0a294d9e3b49026\r\nStatus: Downloaded newer image for prod.local:5002/nginx:latest\r\nprod.local:5002/nginx:latest\n"})}),"\n",(0,n.jsxs)(r.p,{children:["Petit rappel : le port ",(0,n.jsx)(r.code,{children:"5002"})," est celui qui a \xe9t\xe9 mapp\xe9 avec le port ",(0,n.jsx)(r.code,{children:"8082"})," sur lequel nous avons configur\xe9 le registre public."]}),"\n",(0,n.jsxs)(r.p,{children:['Depuis le bouton "Browse", vous pouvez acc\xe9der \xe0 votre proxy Docker Hub, et vous constaterez que l\'image ',(0,n.jsx)(r.strong,{children:"nginx"})," a bien \xe9t\xe9 enregistr\xe9e par Nexus. La prochaine fois que vous effectuerez un pull depuis Nexus, il fournira directement l'image depuis le ",(0,n.jsx)(r.strong,{children:"cache"}),", sans avoir besoin de faire appel au Docker Hub public."]}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"image-20240106223523578",src:s(2989).Z+"",width:"787",height:"331"})}),"\n",(0,n.jsx)(r.h2,{id:"cr\xe9ez-un-registre-docker-priv\xe9",children:"Cr\xe9ez un registre docker priv\xe9"}),"\n",(0,n.jsx)(r.h3,{id:"cr\xe9ez-un-stockage-blob-pour-le-registre-priv\xe9-1",children:"Cr\xe9ez un stockage blob pour le registre priv\xe9"}),"\n",(0,n.jsx)(r.p,{children:'De la m\xeame mani\xe8re que pour le registre public, vous savez maintenant comment faire. Cr\xe9ez un stockage blob, nomm\xe9 par exemple "docker-private", que vous allez utiliser pour stocker les images priv\xe9es.'}),"\n",(0,n.jsx)(r.h3,{id:"cr\xe9ez-un-registre-priv\xe9-docker-hosted",children:"Cr\xe9ez un registre priv\xe9 (docker-hosted)"}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsx)(r.li,{children:'Cliquez sur "Repositories".'}),"\n",(0,n.jsx)(r.li,{children:'Cliquez sur "Create Repository" et s\xe9lectionnez "docker (hosted)".'}),"\n",(0,n.jsx)(r.li,{children:'Donnez-lui un nom, exemple "docker-private"'}),"\n",(0,n.jsx)(r.li,{children:'Cochez "HTTP" et attribuez-lui le port 8083 (c\'est le port que nous avons choisi pour le registre priv\xe9).'}),"\n",(0,n.jsx)(r.li,{children:'Sous Docker Index, s\xe9lectionnez "Use Docker Hub".'}),"\n",(0,n.jsx)(r.li,{children:'Sous Storage > Blob Store, choisissez le Blob Store que vous avez cr\xe9\xe9 pr\xe9c\xe9demment ("docker-private").'}),"\n",(0,n.jsx)(r.li,{children:'Cliquez sur "Create Repository".'}),"\n"]}),"\n",(0,n.jsx)(r.p,{children:"Voil\xe0, vous avez maintenant cr\xe9\xe9 votre registre docker priv\xe9 !"}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"image-20240107021614047",src:s(8203).Z+"",width:"1198",height:"239"})}),"\n",(0,n.jsx)(r.p,{children:"Pour tester notre registre Docker priv\xe9, nous allons cr\xe9er une image de notre application Spring Boot et la pousser vers le registre priv\xe9."}),"\n",(0,n.jsxs)(r.p,{children:["Vous avez cr\xe9\xe9 un proxy Docker Hub, profitez-en ! Modifiez votre Dockerfile pour effectuer le pull depuis le registre Nexus. Ajoutez son URL ",(0,n.jsx)(r.code,{children:"prod.local:5002/"})," devant le nom de l'image, de la m\xeame mani\xe8re que pour la commande ",(0,n.jsx)(r.code,{children:"docker pull"})]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-dockerfile",children:'FROM prod.local:5002/amazoncorretto:17-alpine\r\nCOPY target/*.jar /opt/app/devops-project-samples.jar\r\nEXPOSE 7070\r\nENTRYPOINT ["java","-jar","/opt/app/devops-project-samples.jar"]\n'})}),"\n",(0,n.jsx)(r.p,{children:"Quand vous construisez une image Docker et que vous voulez la pousser vers un registre priv\xe9, son nom doit \xeatre pr\xe9fix\xe9 par l'URL de ce dernier."}),"\n",(0,n.jsx)(r.p,{children:"Depuis la racine de votre projet, ex\xe9cuter la commande suivante pour faire le build de l'image :"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:" docker build -t prod.local:5003/devops-project-samples:latest .\n"})}),"\n",(0,n.jsx)(r.p,{children:"V\xe9rifiez que votre image a bien \xe9t\xe9 cr\xe9\xe9e :"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"PS E:\\workspace\\maven-projects\\devops-project-samples> docker images\r\nREPOSITORY                               TAG                             IMAGE ID       CREATED         SIZE  \r\nprod.local:5003/devops-project-samples   latest                          9b8294df572b   2 minutes ago   309MB \n"})}),"\n",(0,n.jsx)(r.p,{children:"Pour effectuer un push de l'image, similaire \xe0 Docker Hub, vous devez vous authentifier. Vous pouvez utiliser le compte admin pour tester, mais en production, il est recommand\xe9 de cr\xe9er des utilisateurs avec des r\xf4les sp\xe9cifiques plut\xf4t que d'utiliser directement le compte admin."}),"\n",(0,n.jsxs)(r.p,{children:["Commencez alors par ex\xe9cuter la commande ",(0,n.jsx)(r.code,{children:"docker login"})," pour vous connecter au registre priv\xe9 :"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"PS E:\\workspace\\maven-projects\\devops-project-samples> docker login prod.local:5003\r\nUsername: admin\r\nPassword:               \r\n\r\nLogin Succeeded\n"})}),"\n",(0,n.jsxs)(r.p,{children:["Poussez l'image docker de votre application avec la commande ",(0,n.jsx)(r.code,{children:"docker push"})," :"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"PS E:\\workspace\\maven-projects\\devops-project-samples> docker push prod.local:5003/devops-project-samples:latest\r\nThe push refers to repository [prod.local:5003/devops-project-samples]\r\n8a716a5d01c6: Pushed\r\n7e661cbcb912: Layer already exists\r\n9fe9a137fd00: Layer already exists\r\nlatest: digest: sha256:2bcea3be4dc37856bfd0d90ad643c947bcf8c55c5ea3530ecdb12c75789cfea8 size: 953\n"})}),"\n",(0,n.jsx)(r.p,{children:'V\xe9rifiez dans "Browse"  > "docker-private" que votre image a bien \xe9t\xe9 enregistr\xe9e !'}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"image-20240107024638141",src:s(7807).Z+"",width:"724",height:"302"})})]})}function u(e={}){const{wrapper:r}={...(0,o.a)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},5592:(e,r,s)=>{s.d(r,{Z:()=>n});const n=s.p+"assets/images/concept.drawio-3b1328cc69744fc38ccc736a0e93c92a.png"},5919:(e,r,s)=>{s.d(r,{Z:()=>n});const n=s.p+"assets/images/image-20240106125224705-6c8e55a6ca00123bcb00a396da29874b.png"},3938:(e,r,s)=>{s.d(r,{Z:()=>n});const n=s.p+"assets/images/image-20240106174647326-6d96f89ba85841fadca6322e74c673ea.png"},6104:(e,r,s)=>{s.d(r,{Z:()=>n});const n=s.p+"assets/images/image-20240106221518161-c515df13f8348f64ef10e76e5536e165.png"},835:(e,r,s)=>{s.d(r,{Z:()=>n});const n=s.p+"assets/images/image-20240106221918648-db75020512e9dd087977073743ae3c26.png"},2989:(e,r,s)=>{s.d(r,{Z:()=>n});const n=s.p+"assets/images/image-20240106223523578-91cc1e7021661a63c112e2700294bc99.png"},8203:(e,r,s)=>{s.d(r,{Z:()=>n});const n=s.p+"assets/images/image-20240107021614047-1afdef801a26e2613d6cc6ffe9ec4262.png"},7807:(e,r,s)=>{s.d(r,{Z:()=>n});const n=s.p+"assets/images/image-20240107024638141-bd8c5242df544a496397adfac0f50983.png"},1151:(e,r,s)=>{s.d(r,{Z:()=>l,a:()=>c});var n=s(7294);const o={},i=n.createContext(o);function c(e){const r=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:c(e.components),n.createElement(i.Provider,{value:r},e.children)}}}]);