<!doctype html>
<html lang="fr" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Angular/angular" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Angular 16 : Mettre en place l&#x27;authentification et l&#x27;autorisation basée sur les rôles | ON APPREND SANS CESSE</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://mossaabfrifita.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://mossaabfrifita.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://mossaabfrifita.github.io/docs/Angular"><meta data-rh="true" property="og:locale" content="fr"><meta data-rh="true" name="docusaurus_locale" content="fr"><meta data-rh="true" name="docsearch:language" content="fr"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Angular 16 : Mettre en place l&#x27;authentification et l&#x27;autorisation basée sur les rôles | ON APPREND SANS CESSE"><meta data-rh="true" name="description" content="L&#x27;authentification et l&#x27;autorisation sont des éléments essentiels de toute application web moderne. Dans l&#x27;article précédent, nous avons exploré comment implémenter un système d&#x27;authentification robuste en utilisant JWT (JSON Web Tokens) avec Spring Boot et Spring Security. Nous avons ainsi créé une API REST sécurisée. Le code source est disponible sur Github."><meta data-rh="true" property="og:description" content="L&#x27;authentification et l&#x27;autorisation sont des éléments essentiels de toute application web moderne. Dans l&#x27;article précédent, nous avons exploré comment implémenter un système d&#x27;authentification robuste en utilisant JWT (JSON Web Tokens) avec Spring Boot et Spring Security. Nous avons ainsi créé une API REST sécurisée. Le code source est disponible sur Github."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://mossaabfrifita.github.io/docs/Angular"><link data-rh="true" rel="alternate" href="https://mossaabfrifita.github.io/docs/Angular" hreflang="fr"><link data-rh="true" rel="alternate" href="https://mossaabfrifita.github.io/docs/Angular" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.ea9770ca.css">
<script src="/assets/js/runtime~main.5a46b655.js" defer="defer"></script>
<script src="/assets/js/main.0cd224c4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Aller au contenu principal"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Aller au contenu principal</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Ouvrir/fermer la barre de navigation" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/custom-logo.jpg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/custom-logo.jpg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Mossaab Frifita</b></a><a class="navbar__item navbar__link" href="/docs/category/devops-cicd-pipeline">DevOps</a><a class="navbar__item navbar__link" href="/docs/category/spring-framework">Spring</a><a class="navbar__item navbar__link" href="/docs/category/angular">Angular</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/MossaabFrifita" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Basculer entre le mode sombre et clair (actuellement mode clair)" aria-label="Basculer entre le mode sombre et clair (actuellement mode clair)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Retour au début de la page" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/devops-cicd-pipeline">DevOps CI/CD pipeline</a><button aria-label="Développer la catégorie &#x27;DevOps CI/CD pipeline&#x27; de la barre latérale" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/spring-framework">Spring Framework</a><button aria-label="Développer la catégorie &#x27;Spring Framework&#x27; de la barre latérale" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/angular">Angular</a><button aria-label="Réduire la catégorie &#x27;Angular&#x27; de la barre latérale" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Angular">Angular 16 : Mettre en place l&#x27;authentification et l&#x27;autorisation basée sur les rôles</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Fil d&#x27;Ariane"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Page d&#x27;accueil" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/angular"><span itemprop="name">Angular</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Angular 16 : Mettre en place l&#x27;authentification et l&#x27;autorisation basée sur les rôles</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Sur cette page</button></div><div class="theme-doc-markdown markdown"><h1>Angular 16 : Mettre en place l&#x27;authentification et l&#x27;autorisation basée sur les rôles</h1>
<p>L&#x27;authentification et l&#x27;autorisation sont des éléments essentiels de toute application web moderne. Dans <a href="https://www.linkedin.com/pulse/spring-security-authentification-autorisation-avec-jwt-frifita" target="_blank" rel="noopener noreferrer">l&#x27;article</a> précédent, nous avons exploré comment implémenter un système d&#x27;authentification robuste en utilisant JWT (JSON Web Tokens) avec Spring Boot et Spring Security. Nous avons ainsi créé une API REST sécurisée. Le code source est disponible sur Github.</p>
<p>Dans ce nouvel article, nous allons aller plus loin en montrant comment mettre en pratique cette authentification et autorisation basée sur les rôles du côté client en utilisant Angular, l&#x27;un des frameworks JavaScript les plus populaires. En outre, nous allons introduire une amélioration cruciale : l&#x27;envoi du jeton JWT sous forme de cookie HTTP Only.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="quel-est-le-meilleur-endroit-pour-stocker-les-tokens-côté-client-">Quel est le meilleur endroit pour stocker les tokens Côté Client ?<a href="#quel-est-le-meilleur-endroit-pour-stocker-les-tokens-côté-client-" class="hash-link" aria-label="Lien direct vers Quel est le meilleur endroit pour stocker les tokens Côté Client ?" title="Lien direct vers Quel est le meilleur endroit pour stocker les tokens Côté Client ?">​</a></h2>
<p>Après une authentification réussie de l&#x27;utilisateur, notre API Spring Boot renvoie une réponse HTTP au format JSON.</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;id&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;email&quot;: &quot;user@gmail.com&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;roles&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;READ_PRIVILEGE&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;WRITE_PRIVILEGE&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;ROLE_USER&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;access_token&quot;: &quot;eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1c2VyQGdtYWlsLmNvbSIsImlhdCI6MTY5NzExMjg0OSwiZXhwIjoxNjk3MTEzNzQ5fQ.B0yFwrgLoDsVOmfN6Gyr5zLlDq4Wnjha0jchwkqySjE&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;refresh_token&quot;: &quot;NDBmMTUzM2UtODJlYi00NzQxLWIzN2ItODFhNWE0MzllMGM2&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;token_type&quot;: &quot;BEARER&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Le client a la responsabilité de stocker les informations de l&#x27;utilisateur, notamment l&#x27;<code>access_token</code> et le <code>refresh_token</code>, dans un endroit sécurisé.</p>
<p>Il est courant que les développeurs choisissent de sauvegarder ces jetons soit dans le stockage local (localStorage) soit dans des cookies, de manière à les transmettre au backend pour authentifier l&#x27;utilisateur lors de futures requêtes.</p>
<p>Cependant, il est essentiel de prendre en compte les vulnérabilités potentielles associées à ces choix :</p>
<p><strong>Le localStorage est vulnérable aux attaques XSS</strong></p>
<p>En cas d&#x27;injection de code malveillant dans votre application, un attaquant pourrait potentiellement accéder aux données stockées dans le localStorage, y compris les tokens.</p>
<p><em>Comment cela est-il possible ?</em></p>
<p>Sans entrer dans les détails des méthodes spécifiques d&#x27;injection de code malveillant, il est important de comprendre que les attaques XSS (Cross-Site Scripting) surviennent lorsque des acteurs malveillants réussissent à introduire du code JavaScript nuisible dans une application web. Un exemple concret de cette vulnérabilité réside dans l&#x27;utilisation fréquente de bibliothèques JavaScript tierces pour des fonctionnalités courantes, telles que l&#x27;affichage d&#x27;alertes. Par exemple :</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">https://cdn-malveillant.com/monalerte.js</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Ces bibliothèques sont souvent importées en ligne, et si elles sont compromises par des pirates, leur code source peut être modifié. En conséquence, votre application devient vulnérable, car les attaquants peuvent lire et extraire les informations sensibles stockées dans le localStorage. La sécurité de vos utilisateurs est ainsi sérieusement compromise.</p>
<p><strong>Les cookies traditionnels sont vulnérables à la fois aux attaques XSS (Cross-Site Scripting) et aux attaques CSRF (Cross-Site Request Forgery)</strong></p>
<p><em>Comment cela est possible ?</em></p>
<p><strong>Attaques XSS :</strong> Les cookies sont accessibles par JavaScript.</p>
<p><strong>Attaques CSRF :</strong> Les cookies, y compris les cookies de session, sont généralement inclus automatiquement dans chaque requête HTTP. L&#x27;attaque se produit lorsque des demandes effectuées par l&#x27;intermédiaire d&#x27;un site malveillant forcent des utilisateurs authentifiés sur d&#x27;autres sites Web à soumettre une demande au site malveillant, obtenant ainsi l&#x27;accès à leurs informations d&#x27;identification.</p>
<p><em>Quelle est la solution ?</em></p>
<p>Il faut savoir que les mesures de sécurité change d&#x27;une application à l&#x27;autre et qu&#x27;il n&#x27;existe pas la bonne et la mauvaise approche mais vraiment ca dépend des exigences de sécurité de votre application. Selon mon expérience je ne vous conseille pas de stocker les informations sensibles de vos utilisateurs dans le localStorage mais plutôt dans des cookies HTTP only  !</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="lavantage-du-cookie-http-only-avec-securetrue-et-samesitestrict">L&#x27;Avantage du Cookie HTTP Only avec Secure=true et SameSite=Strict<a href="#lavantage-du-cookie-http-only-avec-securetrue-et-samesitestrict" class="hash-link" aria-label="Lien direct vers L&#x27;Avantage du Cookie HTTP Only avec Secure=true et SameSite=Strict" title="Lien direct vers L&#x27;Avantage du Cookie HTTP Only avec Secure=true et SameSite=Strict">​</a></h2>
<p>Maintenant que nous comprenons les vulnérabilités associées au stockage de tokens dans le localStorage ou dans des cookies traditionnels, il est temps d&#x27;explorer pourquoi le choix des cookies HTTP Only avec les paramètres <code>Secure=true</code> et <code>SameSite=Strict</code> est une approche plus sécurisée pour stocker nos <code>access_token</code> et <code>refresh_token</code>.</p>
<p>Les cookies HTTP Only ne sont pas accessibles via JavaScript côté client.</p>
<p>En définissant <code>Secure=true</code>, les cookies ne seront transmis que via HTTPS.</p>
<p><code>SameSite</code> propose 3 politiques différentes, qui seront définies par les valeurs suivantes (sensibles à la casse) : <code>None</code>, <code>Strict</code> et <code>Lax</code>.</p>
<p>Dans notre cas, avec <code>access_token</code> et <code>refresh_token</code>, nous opterons pour l&#x27;attribut <code>SameSite=Strict</code>.</p>
<p>L&#x27;attribut <code>SameSite=Strict</code> limite le risque d&#x27;attaques CSRF : les cookies ne seront pas inclus dans la requête vers un site tiers.</p>
<p><strong>Exemple :</strong> Un utilisateur est sur &quot;monsite.com&quot; et clique sur un lien redirigeant vers &quot;exemple.com&quot;. Si les cookies sont définis comme <code>SameSite=&quot;Strict&quot;</code>, les cookies ne seront pas inclus dans la requête vers &quot;exemple.com&quot;, assurant ainsi une protection maximale contre les attaques CSRF et limitant les risques d&#x27;attaque XSS.</p>
<p>Cependant, cela peut entraîner des limitations dans certaines situations, car certains scénarios, tels que le partage de liens vers des ressources, peuvent ne pas fonctionner comme prévu. je vous laisse explorer les autres options sur ce <a href="https://developer.mozilla.org/fr/docs/Web/HTTP/Headers/Set-Cookie" target="_blank" rel="noopener noreferrer">lien</a> pour trouver la configuration qui convient le mieux à vos besoins spécifiques.</p>
<p><strong>Remarques :</strong></p>
<ul>
<li>Il est important d&#x27;adapter les mesures de sécurité en fonction des besoins spécifiques de votre application et des exigences en matière de sécurité.</li>
<li>Ces options ne doivent pas constituer votre unique défense contre les attaques.</li>
<li>Ne stockez pas les tokens dans le localStorage à moins que vous puissiez garantir une sécurité maximale contre les attaques XSS !</li>
<li>Gardez à l&#x27;esprit que les cookies sont limités à 4 ko, donc assurez-vous que votre JWT n&#x27;excède pas cette taille si vous voulez utiliser des cookies HTTP only pour gérer l&#x27;authentification.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="modification-de-lapi-spring-boot-pour-intégrer-la-gestion-de-cookies-en-session-http-only"><strong>Modification de l&#x27;API Spring Boot pour Intégrer la Gestion de Cookies en Session HTTP Only</strong><a href="#modification-de-lapi-spring-boot-pour-intégrer-la-gestion-de-cookies-en-session-http-only" class="hash-link" aria-label="Lien direct vers modification-de-lapi-spring-boot-pour-intégrer-la-gestion-de-cookies-en-session-http-only" title="Lien direct vers modification-de-lapi-spring-boot-pour-intégrer-la-gestion-de-cookies-en-session-http-only">​</a></h2>
<p>Dans cette section, nous allons apporter des modifications dans l&#x27;API REST que nous avons développée dans <a href="https://www.linkedin.com/pulse/spring-security-authentification-autorisation-avec-jwt-frifita" target="_blank" rel="noopener noreferrer">l&#x27;article</a> précédent pour intégrer la gestion des tokens  <code>access_token</code> et  <code>refresh_token</code> en utilisant des cookies HTTP Only.</p>
<p>Vous pouvez passer directement à la section dédiée à Angular si vous le souhaitez. Le code source complet de l&#x27;API est disponible sur GitHub.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="modification-du-jwtservice-et-du-refreshtokenservice">Modification du JwtService et du refreshTokenService<a href="#modification-du-jwtservice-et-du-refreshtokenservice" class="hash-link" aria-label="Lien direct vers Modification du JwtService et du refreshTokenService" title="Lien direct vers Modification du JwtService et du refreshTokenService">​</a></h3>
<p>Nous allons ajouter les trois méthodes suivantes :</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package fr.mossaab.security.service;   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ResponseCookie generateJwtCookie(String jwt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   String getJwtFromCookies(HttpServletRequest request);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ResponseCookie getCleanJwtCookie();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="génération-dun-cookie-jwt-sécurisé"><strong>Génération d&#x27;un Cookie JWT Sécurisé</strong><a href="#génération-dun-cookie-jwt-sécurisé" class="hash-link" aria-label="Lien direct vers génération-dun-cookie-jwt-sécurisé" title="Lien direct vers génération-dun-cookie-jwt-sécurisé">​</a></h4>
<p>La méthode <code>generateJwtCookie</code> permet d&#x27;encapsuler le jwt dans un cookie HTTP only :</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public ResponseCookie generateJwtCookie(String jwt) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return ResponseCookie.from(jwtCookieName, jwt)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .path(&quot;/&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .maxAge(24 * 60 * 60) // 24 hours in s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .httpOnly(true) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .secure(true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .sameSite(&quot;Strict&quot;) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><em>Explorons les détails de cette méthode</em></p>
<p>Cette méthode est responsable de la génération d&#x27;un cookie sécurisé pour stocker le jeton JWT côté client qui sera envoyé dans le Header de la réponse HTTP, elle crée un objet de type <code>org.springframework.http.ResponseCookie</code> avec la configuration suivante :</p>
<ul>
<li><code>path</code> : Spécifie le chemin pour lequel le cookie est valide.  En définissant le path sur &quot;/&quot;, le cookie est accessible depuis n&#x27;importe quelle URL de notre application</li>
<li><code>maxAge</code> : Durée de validité du cookie en secondes</li>
<li><code>httpOnly</code> : Marquer le cookie comme http-only</li>
<li><code>secure</code> : Le cookie est envoyé uniquement via HTTPS</li>
<li><code>sameSite</code> : Spécifie la politique SameSite</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="récupération-du-jwt-à-partir-des-cookies"><strong>Récupération du JWT à partir des Cookies</strong><a href="#récupération-du-jwt-à-partir-des-cookies" class="hash-link" aria-label="Lien direct vers récupération-du-jwt-à-partir-des-cookies" title="Lien direct vers récupération-du-jwt-à-partir-des-cookies">​</a></h4>
<p>La méthode <code>getJwtFromCookies</code> permet d&#x27;extraire le JWT inclut dans la requête HTTP :</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public String getJwtFromCookies(HttpServletRequest request) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Cookie cookie = WebUtils.getCookie(request, jwtCookieName);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (cookie != null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return cookie.getValue();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="suppression-du-cookie-jwt"><strong>Suppression du Cookie JWT</strong><a href="#suppression-du-cookie-jwt" class="hash-link" aria-label="Lien direct vers suppression-du-cookie-jwt" title="Lien direct vers suppression-du-cookie-jwt">​</a></h4>
<p>Pour déconnecter l&#x27;utilisateur, il suffit de renvoyer au client le cookie jwt vide.</p>
<p>La méthode <code>getCleanJwtCookie</code> permet de le créer tout simplement :</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public ResponseCookie getCleanJwtCookie() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return ResponseCookie.from(jwtCookieName, &quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .path(&quot;/&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>En suivant le même principe que pour le <code>JwtService</code>, le <code>RefreshTokenService</code> doit également être modifié pour intégrer les mêmes méthodes :</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package fr.mossaab.security.service.impl;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public ResponseCookie generateRefreshTokenCookie(String token) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return ResponseCookie.from(refreshTokenName, token)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .path(&quot;/&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .maxAge(refreshExpiration/1000) // 15 days in s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .httpOnly(true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            	.secure(true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .sameSite(&quot;Strict&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public String getRefreshTokenFromCookies(HttpServletRequest request) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Cookie cookie = WebUtils.getCookie(request, refreshTokenName);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (cookie != null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return cookie.getValue();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void deleteByToken(String token) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        refreshTokenRepository.findByToken(token).ifPresent(refreshTokenRepository::delete);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public ResponseCookie getCleanRefreshTokenCookie() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return ResponseCookie.from(refreshTokenName, &quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .path(&quot;/&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="intégration-de-la-récupération-du-cookie-jwt-dans-le-filtre-jwtauthenticationfilter">Intégration de la récupération du Cookie JWT dans le Filtre JwtAuthenticationFilter<a href="#intégration-de-la-récupération-du-cookie-jwt-dans-le-filtre-jwtauthenticationfilter" class="hash-link" aria-label="Lien direct vers Intégration de la récupération du Cookie JWT dans le Filtre JwtAuthenticationFilter" title="Lien direct vers Intégration de la récupération du Cookie JWT dans le Filtre JwtAuthenticationFilter">​</a></h3>
<p>Le filtre <code>JwtAuthenticationFilter</code> permet d&#x27;extraire le JWT du header &quot;Authorization&quot;. Dans cette section, nous allons enrichir ce filtre en lui permettant de récupérer également le JWT depuis les cookies.</p>
<p>Voici ce qu&#x27;il faut modifier :</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected void doFilterInternal(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           @NonNull HttpServletRequest request,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           @NonNull HttpServletResponse response,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           @NonNull FilterChain filterChain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) throws ServletException, IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // try to get JWT in cookie or in Authorization Header</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String jwt = jwtService.getJwtFromCookies(request);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        final String authHeader = request.getHeader(&quot;Authorization&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if((jwt == null &amp;&amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            (authHeader ==  null || !authHeader.startsWith(&quot;Bearer &quot;))) || request.getRequestURI().contains(&quot;/auth&quot;)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            filterChain.doFilter(request, response);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // If the JWT is not in the cookies but in the &quot;Authorization&quot; header</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (jwt == null &amp;&amp; authHeader.startsWith(&quot;Bearer &quot;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            jwt = authHeader.substring(7); // after &quot;Bearer &quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        final String userEmail =jwtService.extractUserName(jwt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Lorsque le filtre intercepte la requête, il essaie de récupérer le JWT, soit en utilisant la méthode que nous avons ajoutée au service JwtService avec l&#x27;appel <code>getJwtFromCookies(request)</code> pour obtenir le JWT à partir des cookies, soit du Header &quot;Authorization&quot;, comme nous l&#x27;avons précédemment fait.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="modification-du-contrôleur-authenticationcontroller">Modification du contrôleur AuthenticationController<a href="#modification-du-contrôleur-authenticationcontroller" class="hash-link" aria-label="Lien direct vers Modification du contrôleur AuthenticationController" title="Lien direct vers Modification du contrôleur AuthenticationController">​</a></h3>
<p>Après une authentification réussie de l&#x27;utilisateur, notre API renvoie une réponse JSON qui contient les tokens <code>access_token</code> et <code>refresh_token</code>.</p>
<p>Cependant, ce qui nous manque ici, c&#x27;est la possibilité d&#x27;envoyer les tokens sous forme de cookies</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    @PostMapping(&quot;/authenticate&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public ResponseEntity&lt;AuthenticationResponse&gt; authenticate(@RequestBody AuthenticationRequest request) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        AuthenticationResponse authenticationResponse = authenticationService.authenticate(request);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ResponseCookie jwtCookie = jwtService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .generateJwtCookie(authenticationResponse.getAccessToken());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ResponseCookie refreshTokenCookie = refreshTokenService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .generateRefreshTokenCookie(authenticationResponse.getRefreshToken());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return ResponseEntity.ok()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .header(HttpHeaders.SET_COOKIE,jwtCookie.toString())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .header(HttpHeaders.SET_COOKIE,refreshTokenCookie.toString())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .body(authenticationResponse);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Les cookies <code>JwtCookie</code> et <code>refreshTokenCookie</code> sont générés à partir de la réponse <code>authenticationResponse</code> et inclus dans la réponse HTTP.</p>
<p>Maintenant il faut avoir la possibilité de rafraichir le <code>access_token</code> quand il expire.</p>
<p>Pour maintenir ce que nous avons fait dans <a href="https://www.linkedin.com/pulse/spring-security-authentification-autorisation-avec-jwt-frifita" target="_blank" rel="noopener noreferrer">l&#x27;article</a> précédent, j&#x27;ai ajouté un nouveau end-point : <code>/refresh-token-cookie</code></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    @PostMapping(&quot;/refresh-token-cookie&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public ResponseEntity&lt;Void&gt; refreshTokenCookie(HttpServletRequest request) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String refreshToken = refreshTokenService.getRefreshTokenFromCookies(request);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RefreshTokenResponse refreshTokenResponse = refreshTokenService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .generateNewToken(new RefreshTokenRequest(refreshToken));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ResponseCookie NewJwtCookie = jwtService.generateJwtCookie(refreshTokenResponse.getAccessToken());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return ResponseEntity.ok()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .header(HttpHeaders.SET_COOKIE, NewJwtCookie.toString())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Lorsque le client envoie une requête à cet endpoint, notre méthode tente de récupérer le <code>refresh_token</code> à partir des cookies de la requête. Ensuite, elle génère un nouveau cookie <code>NewJwtCookie</code> contenant le nouveau jeton d&#x27;accès à partir du <code>refresh_token</code>. Enfin, la méthode renvoie une réponse HTTP 200 (OK) au client, avec le nouveau cookie inclus dans l&#x27;en-tête de la réponse.</p>
<p><em>Remarque : la méthode <code>generateNewToken</code> peut générer des exceptions si le <code>refresh_token</code> n&#x27;est pas valide (comme expliqué dans l&#x27;article précédent). Dans un tel cas, elle renvoie une réponse HTTP 403 (forbidden)</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="implémentation-de-lauthentification-et-de-lautorisation-dans-angular-16">Implémentation de l&#x27;Authentification et de l&#x27;Autorisation dans Angular 16<a href="#implémentation-de-lauthentification-et-de-lautorisation-dans-angular-16" class="hash-link" aria-label="Lien direct vers Implémentation de l&#x27;Authentification et de l&#x27;Autorisation dans Angular 16" title="Lien direct vers Implémentation de l&#x27;Authentification et de l&#x27;Autorisation dans Angular 16">​</a></h2>
<p>L&#x27;application Angular que nous allons construire est un exemple minimal mais complet. Notre objectif est de mettre en place un système d&#x27;authentification basé sur les JWT et les cookies HTTP-Only, tout en abordant l&#x27;autorisation basée sur les rôles.</p>
<p><strong>Les end-points que nous allons utiliser sont :</strong></p>
<ul>
<li>POST <code>api/v1/auth/authenticate</code> pour authentifier les utilisateurs</li>
<li>POST <code>api/v1/auth/logout</code> pour déconnecter les utilisateurs</li>
<li>POST <code>api/v1/auth/refresh-token-cookie</code> pour rafraichir le JWT</li>
<li>POST <code>api/v1/user/resource</code> qui renvoie un message avec  un code HTTP 200 si l&#x27;utilisateur est authentifié, possède le rôle USER ou ADMIN avec le droit d&#x27;écriture (<code>WRITE_PRIVILEGE</code>)</li>
<li>GET <code>api/v1/admin/resource</code> elle renvoie un message avec HTTP 200 si l&#x27;utilisateur est authentifié, possède le rôle ADMIN avec le droit de lecture (<code>READ_PRIVILEGE</code>)</li>
</ul>
<p><strong>Les fonctionnalités à développer sont :</strong></p>
<ul>
<li>Création d&#x27;une page login</li>
<li>Création d&#x27;une page Home accessible aux utilisateurs avec le rôle ADMIN ou USER</li>
<li>Création d&#x27;une page Admin accessible uniquement aux utilisateurs avec le rôle ADMIN</li>
<li>Auto-Login permet aux utilisateurs authentifiés de rester connectés sans avoir à saisir à chaque fois leurs informations d&#x27;identification</li>
<li>Auto-Logout permet la déconnexion automatique pour améliorer la sécurité de la session utilisateur</li>
<li>Création d&#x27;une barre de navigation dynamique qui s&#x27;affiche en fonction des rôles des utilisateurs. La barre de navigation offrira des liens spécifiques en fonction du rôle de l&#x27;utilisateur</li>
<li>Rafraîchissement Automatique du JWT : Cette fonctionnalité garantira que les utilisateurs restent connectés de manière transparente en actualisant automatiquement leur JWT.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="création-du-projet-angular">Création du projet Angular<a href="#création-du-projet-angular" class="hash-link" aria-label="Lien direct vers Création du projet Angular" title="Lien direct vers Création du projet Angular">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="prérequis-">Prérequis :<a href="#prérequis-" class="hash-link" aria-label="Lien direct vers Prérequis :" title="Lien direct vers Prérequis :">​</a></h4>
<p>Node.js et npm : Assurez-vous que Node.js est installé sur votre système, car il est nécessaire pour exécuter Angular CLI. Vous pouvez télécharger Node.js à partir du site officiel : <a href="https://nodejs.org/" target="_blank" rel="noopener noreferrer">https://nodejs.org/</a>.</p>
<ol>
<li>Angular CLI : <code>npm install -g @angular/cli</code></li>
<li>Création d&#x27;un nouveau projet Angular : <code>ng new [nom_projet]</code></li>
<li>Installation de Bootstrap : <code>npm install bootstrap --save</code></li>
<li>Intégration de Bootstrap dans le projet Angular en modifiant le fichier <code>angular.json</code> :</li>
</ol>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&quot;styles&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;src/styles.scss&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;node_modules/bootstrap/dist/css/bootstrap.min.css&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;scripts&quot;:[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;node_modules/bootstrap/dist/js/bootstrap.bundle.js&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><em><strong>Remarque :</strong> Les étapes de configuration de Bootstrap dans ce tutoriel sont fournies à titre indicatif. Vous êtes libre de choisir d&#x27;autres frameworks ou bibliothèques CSS, ou de personnaliser davantage la configuration en fonction de vos préférences et des exigences de votre projet. Le but est de vous montrer le processus de configuration de base, et vous pouvez l&#x27;adapter en conséquence.</em></p>
<p>Générez les composants et les services suivants :</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ng g s _services/auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ng g s _services/storage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ng g s _services/user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ng g interceptor _helpers/http</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ng g g _helpers/auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ng g i _models/user.model</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ng g i _models/role.model</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ng g c login</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ng g c header</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ng g c admin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ng g c home</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ng g c errors/access-denied</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Ajoutez le <code>router-outlet</code> dans le composant principale de l&#x27;application <code>app.component.html</code> qui servira de conteneur pour afficher le contenu des composants associés aux différentes routes lorsque la navigation se produit</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">router-outlet</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">router-outlet</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Voici la structure de notre application Angular :</p>
<p><img decoding="async" loading="lazy" src="/assets/images/angular-project-structure-57cf1b1cf1e9909973843ed4c1423932.PNG" width="349" height="887" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="création-des-modèles-user-et-role">Création des modèles User et Role<a href="#création-des-modèles-user-et-role" class="hash-link" aria-label="Lien direct vers Création des modèles User et Role" title="Lien direct vers Création des modèles User et Role">​</a></h3>
<p>Pour mieux structurer les données manipulées par notre application, créez les interfaces <code>User</code> et <code>Role</code> sous le répertoire <code>_models</code>.</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Role</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./role.model&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">User</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  id</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  email</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  role</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Role</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">Role</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  permissions</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Comme vous pouvez le constater, un utilisateur possède un rôle, tandis qu&#x27;un rôle se caractérise par un nom et un tableau de chaînes représentant les autorisations.</p>
<p>Les <code>access_token</code> et <code>refresh_token</code> ne sont pas définis dans les propriétés de l&#x27;utilisateur, car ils seront stockés dans les cookies HTTP-only. En revanche, les autres propriétés seront stockées dans le localStorage du navigateur puisque ils ne contiennent pas de données sensibles.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="création-du-service-storage">Création du service Storage<a href="#création-du-service-storage" class="hash-link" aria-label="Lien direct vers Création du service Storage" title="Lien direct vers Création du service Storage">​</a></h3>
<p>Créez le service <code>StorageService</code> :</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ng g s _services/storage</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>StorageService</code>  gère le stockage, la récupération et la supression des informations de l&#x27;utilisateur authentifié (<code>User</code>) dans le localStorage du navigateur. Cela permet de maintenir la persistance des données de l&#x27;utilisateur entre les sessions de navigation.</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> Injectable </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@angular/core&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">User</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;../_models/user.model&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">USER_KEY</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;authenticated-user&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator at operator" style="color:#393A34">@</span><span class="token decorator function" style="color:#d73a49">Injectable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  providedIn</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;root&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">StorageService</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">constructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">saveUser</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> User</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">localStorage</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">removeItem</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">USER_KEY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">localStorage</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setItem</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">USER_KEY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">JSON</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">stringify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">getSavedUser</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> User </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> user </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">localStorage</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getItem</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">USER_KEY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">JSON</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">clean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">localStorage</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">clear</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Le <code>localStorage</code> est facilement manipulé à l&#x27;aide des méthodes <code>setItem</code>, <code>getItem</code> et <code>removeItem</code>, qui fonctionnent avec un couple clé-valeur.</p>
<p>L&#x27;objet User est enregistré au format JSON en utilisant <code>JSON.stringify(user)</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="comprendre-le-mécanisme-dauthentification-avec-des-cookies-http-only">Comprendre le mécanisme d&#x27;authentification avec des cookies HTTP-only<a href="#comprendre-le-mécanisme-dauthentification-avec-des-cookies-http-only" class="hash-link" aria-label="Lien direct vers Comprendre le mécanisme d&#x27;authentification avec des cookies HTTP-only" title="Lien direct vers Comprendre le mécanisme d&#x27;authentification avec des cookies HTTP-only">​</a></h3>
<p><img decoding="async" loading="lazy" alt="image-20231016173244505" src="/assets/images/image-20231016173244505-f975500a66a89a0144b03abeb6637310.png" width="731" height="311" class="img_ev3q"></p>
<p>Lorsque l&#x27;utilisateur s&#x27;authentifie, le service <code>AuthService</code> prend en charge l&#x27;appel à notre API pour effectuer l&#x27;authentification. En cas de succès, le serveur renvoie une réponse avec le code HTTP 200 contenant les informations de l&#x27;utilisateur. Le rôle du <code>AuthService</code> est ensuite de déléguer la persistance de ces informations (ID, email, rôles) au <code>StorageService</code>, qui les stocke dans le <code>localStorage</code>.</p>
<p>Le serveur, quant à lui, transmet le <code>access_token</code> et le <code>refresh_token</code> via des cookies HTTP-only. Le client doit ainsi conserver ces cookies et les inclure dans les futures demandes adressées au serveur. Cette démarche garantit la continuité de l&#x27;authentification de l&#x27;utilisateur lors de ses interactions ultérieures.</p>
<p>Ce qu&#x27;il est essentiel de retenir de tout cela :</p>
<ul>
<li>Les informations (ID, email, rôles) sont stockées dans le <code>localStorage</code>.</li>
<li>Les tokens (access_token, refresh_token) sont conservés dans des cookies HTTP-only.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="création-du-service-authentification">Création du service Authentification<a href="#création-du-service-authentification" class="hash-link" aria-label="Lien direct vers Création du service Authentification" title="Lien direct vers Création du service Authentification">​</a></h3>
<p>L&#x27;objectif principal du service <code>AuthService</code> est de gérer l&#x27;authentification de l&#x27;utilisateur et de fournir un moyen d&#x27;accéder aux informations de l&#x27;utilisateur authentifié dans toute l&#x27;application.</p>
<p>Pour atteindre cet objectif, nous utiliserons les observables de <code>RxJS</code>, une bibliothèque JavaScript populaire utilisée par Angular pour la programmation réactive avec ses observables. Le principe de base d&#x27;un observable est assez simple :</p>
<ul>
<li>Un Observable est un objet qui émet des valeurs du même type au fil du temps.</li>
<li>Il peut également émettre une erreur à tout moment, après quoi il est considéré comme terminé et ne produira plus de valeurs.</li>
<li>Nous observons un Observable et réagissons à ses émissions en utilisant sa méthode <code>subscribe()</code>.</li>
</ul>
<p>C&#x27;est précisément l&#x27;intérêt de cette approche ! Nous allons créer un Observable qui sera utilisé pour stocker l&#x27;objet User et avertir les autres composants lorsque l&#x27;utilisateur se connecte et se déconnecte de l&#x27;application.</p>
<p>En Angular, un service décoré avec <code>@Injectable({ providedIn: &#x27;root&#x27; })</code> est un singleton, ce qui signifie qu&#x27;il sera créé une seule fois pour toute l&#x27;application et sera disponible pour être injecté dans tous les composants. Cela nous permet de centraliser la gestion de l&#x27;état de l&#x27;utilisateur dans le service d&#x27;authentification, assurant ainsi sa cohérence et sa mise à jour partout dans l&#x27;application.</p>
<p>Pour extraire (ID, email, rôles) de la réponse créer l&#x27;interface <code>AuthResponseData</code></p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">AuthResponseData</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  id </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  email </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  roles </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Les autres attributs seront ignorés automatiquement.</p>
<p>Injectez le <code>HttpClient</code> et le <code>StorageService</code> dans le constructeur du service. Le service <code>AuthService</code> dépend du <code>HttpClient</code> pour effectuer des requêtes HTTP vers l&#x27;API d&#x27;authentification.</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">constructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> http</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> HttpClient</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> storageService</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> StorageService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><em>Assurez-vous d&#x27;importer le module <code>HttpClientModule</code> dans votre application. Vous pouvez le faire dans le fichier <code>app.module.ts</code> de votre application.</em></p>
<p>Comme nous l&#x27;avons déjà expliqué, le <code>AuthService</code> doit stocker l&#x27;utilisateur actuellement authentifié dans un Observable, et dans ce cas, nous choisissons d&#x27;utiliser un <code>BehaviorSubject</code>.</p>
<p>Le <code>BehaviorSubject</code> est un type d&#x27;Observable qui conserve la dernière valeur émise, ce qui en fait une excellente option pour stocker l&#x27;état de l&#x27;utilisateur connecté. De plus, il peut être initialisé avec une valeur par défaut, comme <code>null</code>, garantissant ainsi qu&#x27;une valeur initiale est toujours disponible, même avant l&#x27;authentification de l&#x27;utilisateur.</p>
<p>Créez l&#x27;objet <code>BehaviorSubject</code> <code>AuthenticatedUser$</code> et initialisez-le à <code>null</code>.</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">AuthenticatedUser$  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">BehaviorSubject</span><span class="token class-name operator" style="color:#393A34">&lt;</span><span class="token class-name">User </span><span class="token class-name operator" style="color:#393A34">|</span><span class="token class-name"> </span><span class="token class-name keyword" style="color:#00009f">null</span><span class="token class-name operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>AuthenticatedUser$</code> commence avec une valeur nulle, ce qui signifie qu&#x27;au départ, aucun utilisateur n&#x27;est authentifié.</p>
<p>Ensuite, il est nécessaire de créer une méthode <code>login</code> qui est au cœur du processus d&#x27;authentification :</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> Injectable </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@angular/core&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">HttpClient</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;@angular/common/http&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">BehaviorSubject</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> catchError</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tap</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> throwError</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;rxjs&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">User</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;../_models/user.model&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">StorageService</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./storage.service&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">AuthResponseData</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  id </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  email </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  roles </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator at operator" style="color:#393A34">@</span><span class="token decorator function" style="color:#d73a49">Injectable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  providedIn</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;root&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">AuthService</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AuthenticatedUser$  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">BehaviorSubject</span><span class="token class-name operator" style="color:#393A34">&lt;</span><span class="token class-name">User </span><span class="token class-name operator" style="color:#393A34">|</span><span class="token class-name"> </span><span class="token class-name keyword" style="color:#00009f">null</span><span class="token class-name operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">constructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> http</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> HttpClient</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> storageService</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> StorageService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">login</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">email </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> password</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token generic-function function" style="color:#d73a49">request</span><span class="token generic-function generic class-name operator" style="color:#393A34">&lt;</span><span class="token generic-function generic class-name">AuthResponseData</span><span class="token generic-function generic class-name operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;post&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;http://localhost:8086/api/v1/auth/authenticate&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        body </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">email</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> password</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        withCredentials </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">catchError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> errorMessage </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;An unknown error occurred!&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">message </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Bad credentials&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            errorMessage </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;The email address or password you entered is invalid&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">throwError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain">  </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">errorMessage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">tap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          user </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> extractedUser </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> User </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              email</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">email</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              id</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              role </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                name </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">roles</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">find</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">role </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> role</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">includes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;ROLE&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                permissions </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">roles</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">permission </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">permission</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">includes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;ROLE&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">storageService</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">saveUser</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">extractedUser</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AuthenticatedUser$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">extractedUser</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>la méthode login utilise la méthode <code>http.request</code> du service <code>HttpClient</code> d&#x27;Angular pour envoyer une requete HTTP post au serveur. Elle renvoie un Observable de type <code>HttpResponse</code> ce qui nous permet d&#x27;utiliser les opérateurs RxJS tels que <code>pipe</code>, <code>map</code>, <code>catchError</code>, et <code>tap</code> pour effectuer des opérations sur l&#x27;Observable renvoyé par <code>http.request</code> et traiter la réponse de la requête HTTP.</p>
<p>Les informations d&#x27;identification de l&#x27;utilisateur (email et password) sont transmises dans le <code>body</code> de la requête HTTP.</p>
<p>L&#x27;option <code>withCredentials: true</code> est définie pour permettre le partage de cookies avec le serveur. En raison des politiques de sécurité relatives aux cookies dans les navigateurs, ils ne sont pas automatiquement inclus lorsque les domaines (et les ports) sont différents. En spécifiant cette option, vous autorisez explicitement le partage de cookies entre l&#x27;application Angular et l&#x27;API.</p>
<p>La méthode <code>pipe</code> est utilisée pour chaîner des opérations sur l&#x27;Observable.</p>
<p>L&#x27;opérateur <code>catchError</code> est utilisé pour intercepter et gérer les erreurs renvoyées par l&#x27;API. Il est fortement recommandé de gérer les erreurs au niveau des services, car cela représente une bonne pratique de développement. Cette approche permet de centraliser la gestion des erreurs pour un service donné, assurant ainsi la cohérence de la gestion des erreurs dans toute l&#x27;application.</p>
<p>Le type de l&#x27;erreur renvoyé est <code>HttpErrorResponse</code> qui est un objet JSON, voici son contenu sur le console :</p>
<p><img decoding="async" loading="lazy" alt="image-20231016221545010" src="/assets/images/image-20231016221545010-2dedf2e6727ea02c49e05317bf7be676.png" width="651" height="336" class="img_ev3q"></p>
<p>Nous pouvons donc accèder aux informations associées pour mieux comprendre et gérer l&#x27;erreur.</p>
<p>Dans notre cas, nous utilisons une condition <code>if (err.error.message === &#x27;Bad credentials&#x27;)</code> pour identifier le type d&#x27;erreur. L&#x27;objet &quot;error&quot; que vous voyez est un objet que nous avons créé dans notre API pour être renvoyé en cas d&#x27;erreur.</p>
<p>Pour obtenir plus de détails sur les réponses possibles de l&#x27;end-point <code>/api/v1/auth/authenticate</code>, je vous encourage à consulter la documentation de l&#x27;API via l&#x27;URL <code>/swagger-ui/index.html</code>. Cela vous permettra d&#x27;explorer les différentes réponses possibles et de comprendre la structure des objets d&#x27;erreur renvoyés par l&#x27;API.</p>
<p><img decoding="async" loading="lazy" alt="image-20231016225628911" src="/assets/images/image-20231016225628911-686b2341e5f7ac4a524f4174b1ef1797.png" width="534" height="303" class="img_ev3q"></p>
<p>C&#x27;est pourquoi chaque API peut renvoyer un objet d&#x27;erreur différent en fonction de sa logique métier et de sa structure de données. Il est essentiel de consulter la documentation de l&#x27;API pour comprendre le type de réponse d&#x27;erreur attendu.</p>
<p>Si tout se passe bien, la méthode <code>pipe</code> continue avec l&#x27;opération <code>tap</code>. Cette opération est utilisée pour effectuer des actions sur les données de la réponse HTTP.</p>
<p>Dans notre cas, elle extrait les informations de l&#x27;utilisateur depuis la réponse de la requête, les données que nous attendons sont de type <code>AuthResponseData</code>  ce qui facilite leur traitement et du coup la création d&#x27;un objet User.</p>
<p>Cet objet utilisateur est ensuite sauvegardé dans le localStorage pour assurer la persistance des données entre les sessions, et il est ensuite émis dans l&#x27;observable <code>AuthenticatedUser$</code>.</p>
<p>Nous explorerons ensuite la manière de souscrire à cet observable pour rester au courant des modifications de l&#x27;état de l&#x27;utilisateur connecté, nous permettant ainsi d&#x27;adapter nos actions en conséquence.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="module-de-routage-dapplication">Module de routage d&#x27;application<a href="#module-de-routage-dapplication" class="hash-link" aria-label="Lien direct vers Module de routage d&#x27;application" title="Lien direct vers Module de routage d&#x27;application">​</a></h3>
<p>Le module de routage d&#x27;application (<code>AppRoutingModule</code>) est un élément essentiel d&#x27;Angular qui permet de gérer la navigation et de définir quel composant s&#x27;affiche lorsque différentes URL sont accédées. Dans notre application, il est utilisé pour diriger les utilisateurs vers la page de connexion (<strong>login</strong>), la page d&#x27;accueil (<strong>home</strong>), la page d&#x27;administration (<strong>admin</strong>), ou encore la page d&#x27;accès refusé (<strong>forbidden</strong>), en fonction de leur statut d&#x27;authentification et de leurs rôles.</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> NgModule </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@angular/core&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> RouterModule</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Routes </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@angular/router&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">LoginComponent</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./login/login.component&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">HomeComponent</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./home/home.component&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">authGuard</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./_helpers/auth.guard&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">AccessDeniedComponent</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./errors/access-denied/access-denied.component&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">AdminComponent</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./admin/admin.component&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> routes</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Routes </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    path</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    redirectTo</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&#x27;/home&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pathMatch</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;full&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    path</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;login&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    component</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">LoginComponent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    path</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;home&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    component</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> HomeComponent </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    canActivate</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">authGuard</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">roles</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;ROLE_ADMIN&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;ROLE_USER&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    path</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;admin&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    component</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> AdminComponent</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    canActivate</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">authGuard</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">roles</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;ROLE_ADMIN&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    path</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;forbidden&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    component</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> AccessDeniedComponent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    path</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;**&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    redirectTo</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/home&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator at operator" style="color:#393A34">@</span><span class="token decorator function" style="color:#d73a49">NgModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  imports</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">RouterModule</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">forRoot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">routes</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  exports</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">RouterModule</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">AppRoutingModule</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Pour protéger les routes, nous utilisons le système de <code>guards</code> d&#x27;Angular avec l&#x27;utilisation de <code>canActivate: [authGuard]</code>. L&#x27;<code>authGuard</code> est un guard que nous implémenterons dans la section suivante, et il permet d&#x27;autoriser l&#x27;accès uniquement aux utilisateurs authentifiés ayant le rôle requis par la route.</p>
<p>La propriété <code>data</code> est un objet qui contient une clé <code>roles</code>, laquelle a pour valeur un tableau de rôles. Elle est utilisée pour spécifier les rôles requis afin d&#x27;accéder à une route particulière.</p>
<p><strong>En résumé :</strong></p>
<ul>
<li>La route <code>home</code> est accessible uniquement aux utilisateurs authentifiés qui ont le rôle <code>ROLE_ADMIN</code> ou <code>ROLE_USER</code>.</li>
<li>Lorsqu&#x27;aucune URL n&#x27;est fournie (<code>path: &#x27;&#x27;</code>), l&#x27;utilisateur est redirigé vers <code>/home</code>.</li>
<li>La route <code>admin</code> est accessible uniquement aux utilisateurs authentifiés qui ont le rôle <code>ROLE_ADMIN</code>.</li>
<li>La route <code>login</code> est accessible à tout le monde.</li>
<li>La route <code>forbidden</code> permet d&#x27;afficher un composant qui affiche un message d&#x27;accès non autorisé en cas d&#x27;erreur HTTP 403.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="garde-dauthentification">Garde d&#x27;authentification<a href="#garde-dauthentification" class="hash-link" aria-label="Lien direct vers Garde d&#x27;authentification" title="Lien direct vers Garde d&#x27;authentification">​</a></h3>
<p>Le guard <code>authGuard</code> est un composant essentiel de notre application Angular qui joue un rôle clé dans la sécurité des routes. Il est utilisé pour restreindre l&#x27;accès aux différentes parties de l&#x27;application en fonction de l&#x27;état de l&#x27;utilisateur connecté et des rôles associés. Le code du <code>authGuard</code> est le suivant :</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">CanActivateFn</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Router</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@angular/router&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">inject</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;@angular/core&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">AuthService</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;../_services/auth.service&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">map</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> take</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;rxjs&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> authGuard</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">CanActivateFn</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  route</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  state</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> router </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">inject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Router</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> authService </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">inject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">AuthService</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> authService</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AuthenticatedUser$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">take</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// take the first one and then unsubscribe automatically</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// check if route is restricted by role</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> roles </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> route</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">role </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> roles</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">includes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">role</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain">  router</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">createUrlTree</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;/forbidden&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain">  router</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">createUrlTree</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;/login&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><em><strong>Remarque</strong> : Nous utilisons les gardes de route fonctionnels introduits dans la version 14.2 d&#x27;Angular, qui sont basés sur des fonctions plutôt que sur des classes. Avant cette version, la seule manière de créer des gardes de route était basée sur des classes qui implémentaient l&#x27;interface <code>CanActivate</code>, maintenant <code>deprecated</code> dans la version actuelle 16. Cependant, le principe reste le même : la route est activée si la fonction <code>CanActivateFn</code> retourne vrai.</em></p>
<p>Pour vérifier si un utilisateur est actuellement authentifié, nous observons l&#x27;<code>AuthenticatedUser$</code> fourni par le service <code>AuthService</code>. Il est important de noter que <code>AuthenticatedUser$</code> est un <code>BehaviorSubject</code> qui renvoie la valeur <code>null</code> par défaut.</p>
<p>L&#x27;utilisation de l&#x27;opérateur <code>take(1)</code> garantit que nous observons uniquement la première valeur émise par l&#x27;observable, puis nous nous désabonnons automatiquement. Cela est suffisant car nous n&#x27;avons besoin que de la première valeur pour prendre une décision concernant l&#x27;accès à la route.</p>
<p>Ensuite, nous utilisons l&#x27;opérateur <code>map</code> de RxJS pour transformer l&#x27;objet <code>User</code> en une décision (vrai ou faux) :</p>
<ul>
<li>Si l&#x27;utilisateur est authentifié et a le rôle requis, l&#x27;accès est autorisé (<code>return true</code>).</li>
<li>Si l&#x27;utilisateur est authentifié mais n&#x27;a pas le rôle requis, il est redirigé vers la page d&#x27;accès refusé (<code>/forbidden</code>).</li>
<li>Si l&#x27;utilisateur n&#x27;est pas authentifié, il est redirigé vers la page de connexion (<code>/login</code>)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="création-de-la-page-login">Création de la page login<a href="#création-de-la-page-login" class="hash-link" aria-label="Lien direct vers Création de la page login" title="Lien direct vers Création de la page login">​</a></h3>
<p>Le composant login gère le formulaire de connexion, la validation des données d&#x27;identification et l&#x27;authentification des utilisateurs, assurant ainsi un accès sécurisé à l&#x27;application.</p>
<p><strong>login.component.ts</strong></p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Component</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> OnDestroy</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> OnInit</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@angular/core&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">NgForm</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;@angular/forms&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">AuthService</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;../_services/auth.service&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Router</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;@angular/router&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Subscription</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;rxjs&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator at operator" style="color:#393A34">@</span><span class="token decorator function" style="color:#d73a49">Component</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  selector</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;app-login&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  templateUrl</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;./login.component.html&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  styleUrls</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;./login.component.scss&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">LoginComponent</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">OnInit</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">OnDestroy </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  errorMessage</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AuthUserSub</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Subscription</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">constructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> authService </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> AuthService</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> router </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Router</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">ngOnInit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AuthUserSub </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">authService</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AuthenticatedUser$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function-variable function" style="color:#d73a49">next</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> user </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">router</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">navigate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;home&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">onSubmitLogin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">formLogin</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> NgForm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">formLogin</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">valid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> email </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> formLogin</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">email</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> password </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> formLogin</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">password</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">authService</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">login</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">email</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> password</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function-variable function" style="color:#d73a49">next</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> userData </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">router</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">navigate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;home&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function-variable function" style="color:#d73a49">error</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">errorMessage </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">ngOnDestroy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AuthUserSub</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">unsubscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Lorsque la page login est initialisée (<code>ngOnInit</code>), un abonnement (<code>subscribe</code>) est créé à l&#x27;observable <code>AuthenticatedUser$</code> du service d&#x27;authentification (<code>AuthService</code>).</p>
<p>Le but est de vérifier si un utilisateur est déjà connecté et qu&#x27;il accède à la page login, il est immédiatement redirigé vers la page d&#x27;accueil (home) sans avoir besoin de se reconnecter. Cela améliore l&#x27;expérience utilisateur en évitant une double authentification inutile.</p>
<p>Il est important de désabonner d&#x27;un observable que vous avez créé dans vos composants Angular lorsque vous avez fini de les utiliser dans <code>ngOnDestroy()</code>. Contrairement à <code>HttpClient</code>, Angular ne gère pas automatiquement le désabonnement de vos observables personnalisés.</p>
<p>La méthode <code>onSubmitLogin</code> est appelée lorsque l&#x27;utilisateur soumet le formulaire de connexion. Dans notre exemple, nous utilisons l&#x27;approche <code>Template Driven Form</code>.</p>
<p>Cette méthode s&#x27;abonne à l&#x27;observable retourné par <code>this.authService.login</code>,  auquel elle transmet le login et le password. Lorsque la requête d&#x27;authentification réussit, la fonction <code>next</code> est déclenchée, et l&#x27;utilisateur est redirigé vers la page d&#x27;accueil (<code>this.router.navigate([&#x27;home&#x27;])</code>), indiquant que l&#x27;authentification a réussi.</p>
<p>En cas d&#x27;erreur lors de la requête d&#x27;authentification, la fonction <code>error</code> est déclenchée. L&#x27;erreur (<code>err</code>) est capturée et stockée dans la variable <code>errorMessage</code>, qui sera affichée dans le template pour informer l&#x27;utilisateur de l&#x27;échec de l&#x27;authentification.</p>
<p><em>Remarque : <code>errorMessage</code> contient le message d&#x27;erreur personnalisé que nous avons défini dans <code>auhService</code>  dans le bloc <code>catchError</code> de la méthode login</em></p>
<p><strong>login.component.html</strong></p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">container mt-5</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">row justify-content-center</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">col-md-6</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">card</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">card-body</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">h4</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">card-title</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Login</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">h4</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">alert alert-danger</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">*ngIf</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">errorMessage</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">{{errorMessage}}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">form</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">#formLogin</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">ngForm</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">(ngSubmit)</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">onSubmitLogin(formLogin)</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">mb-3</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">label</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">for</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">email</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">form-label</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Email</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">label</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">input</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">                </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">email</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">                </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">form-control</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">                </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">email</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">                </span><span class="token tag attr-name" style="color:#00a4db">placeholder</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">Email Address</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">                </span><span class="token tag attr-name" style="color:#00a4db">ngModel</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">                </span><span class="token tag attr-name" style="color:#00a4db">#email</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">ngModel</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">                </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">email</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">                </span><span class="token tag attr-name" style="color:#00a4db">required</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">                </span><span class="token tag attr-name" style="color:#00a4db">email</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">*ngIf</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">email.errors &amp;&amp; formLogin.submitted</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">text-danger</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Email is required!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">mb-3</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">label</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">for</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">password</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">form-label</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Password</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">label</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">input</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">                </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">password</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">                </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">form-control</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">                </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">password</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">                </span><span class="token tag attr-name" style="color:#00a4db">placeholder</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">Password</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">                </span><span class="token tag attr-name" style="color:#00a4db">ngModel</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">                </span><span class="token tag attr-name" style="color:#00a4db">#password</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">ngModel</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">                </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">password</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">                </span><span class="token tag attr-name" style="color:#00a4db">required</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">                </span><span class="token tag attr-name" style="color:#00a4db">minlength</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">6</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">*ngIf</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">password.errors &amp;&amp; formLogin.submitted</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">text-danger</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">*ngIf</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">password.errors[&#x27;required&#x27;]</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Password is required</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">*ngIf</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">password.errors[&#x27;minlength&#x27;]</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Password must be at least 6 characters</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">button</span><span class="token tag" style="color:#00009f">  </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">submit</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">btn btn-primary</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Login</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">button</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">form</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Le modèle de la page login est constitué d&#x27;un formulaire HTML simple avec deux champs (email et mot de passe) comprenant des règles de validation. Pour implémenter cette logique, nous avons opté pour l&#x27;approche des &quot;Template Driven Forms&quot; d&#x27;Angular.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="création-dune-barre-de-navigation-dynamique">Création d&#x27;une barre de navigation dynamique<a href="#création-dune-barre-de-navigation-dynamique" class="hash-link" aria-label="Lien direct vers Création d&#x27;une barre de navigation dynamique" title="Lien direct vers Création d&#x27;une barre de navigation dynamique">​</a></h3>
<p><strong>header.component.html</strong></p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">nav</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">navbar navbar-expand-lg navbar-light bg-light</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">container-fluid</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">a</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">navbar-brand</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Angular JWT Auth</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">a</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">button</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">navbar-toggler</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">button</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">data-bs-toggle</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">collapse</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">data-bs-target</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">#navbarSupportedContent</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">aria-</span><span class="token tag" style="color:#00009f">		</span><span class="token tag attr-name" style="color:#00a4db">controls</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">navbarSupportedContent</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">aria-expanded</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">false</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">aria-label</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">Toggle navigation</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">span</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">navbar-toggler-icon</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">span</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">button</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">collapse navbar-collapse</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">navbarSupportedContent</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">ul</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">navbar-nav me-auto mb-2 mb-lg-0</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">li</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">nav-item</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">a</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">nav-link</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">aria-current</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">page</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f">  </span><span class="token tag attr-name" style="color:#00a4db">routerLink</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">/home</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">routerLinkActive</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">active</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Home</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">a</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">li</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">li</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">nav-item</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">*ngIf</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">showAdminBoard</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">a</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">nav-link</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">routerLink</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">/admin</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">routerLinkActive</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">active</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Admin Board</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">a</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">li</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">ul</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">form</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">d-flex</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">button</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">btn btn-outline-danger</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">submit</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">(click)</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">handleLogout()</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">logout</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">button</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">form</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">nav</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Notre barre de navigation est un simple menu de navigation Bootstrap qui permet de passer d&#x27;une page à l&#x27;autre, &quot;Home&quot; et &quot;Admin&quot;. Étant donné que la page &quot;Admin&quot; est uniquement accessible aux utilisateurs ayant le rôle admin, la visibilité de l&#x27;onglet &quot;Admin&quot; dépend du rôle de l&#x27;utilisateur grâce à l&#x27;utilisation de <code>*ngIf=&quot;showAdminBoard&quot;</code>.</p>
<p>Nous avons aussi un bouton de déconnexion qui déclenche la fonction <code>handleLogout()</code> lorsqu&#x27;il est cliqué.</p>
<p><strong>header.component.ts</strong></p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Component</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> OnDestroy</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> OnInit</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@angular/core&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">AuthService</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;../_services/auth.service&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Subscription</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;rxjs&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator at operator" style="color:#393A34">@</span><span class="token decorator function" style="color:#d73a49">Component</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  selector</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;app-header&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  templateUrl</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;./header.component.html&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  styleUrls</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;./header.component.scss&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">HeaderComponent</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">OnInit</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> OnDestroy</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">constructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> authService </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> AuthService</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  showAdminBoard </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AuthUserSub</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Subscription</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">ngOnInit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AuthUserSub </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">authService</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AuthenticatedUser$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function-variable function" style="color:#d73a49">next</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> user </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">showAdminBoard </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">role</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ROLE_ADMIN&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">handleLogout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">authService</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">logout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">ngOnDestroy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AuthUserSub</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">unsubscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>La variable <code>showAdminBoard</code> est initialement définie sur &quot;false&quot;. Lors de l&#x27;initialisation du composant, nous récupérons simplement l&#x27;utilisateur actuellement authentifié pour vérifier s&#x27;il possède le rôle d&#x27;administrateur (ROLE_ADMIN). En fonction de cette vérification, nous mettons à jour la variable <code>showAdminBoard</code>. Cette variable est utilisée dans le template pour refléter dynamiquement les changements : elle permet d&#x27;afficher ou de masquer l&#x27;onglet &quot;Admin&quot; en fonction du rôle de l&#x27;utilisateur connecté.</p>
<p>La méthode <code>handleLogout()</code> appelle la méthode <code>logout()</code> du service <code>authService</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="implémentation-de-la-méthode-logout-dans-le-service-authservice">Implémentation de la méthode logout dans le service authService<a href="#implémentation-de-la-méthode-logout-dans-le-service-authservice" class="hash-link" aria-label="Lien direct vers Implémentation de la méthode logout dans le service authService" title="Lien direct vers Implémentation de la méthode logout dans le service authService">​</a></h3>
<p>Ajoutez la méthode <code>logout</code> dans le service <code>authService</code>. Elle fait appel à l&#x27;endpoint <code>logout</code> de l&#x27;API, qui renvoie les cookies <code>access_token</code> et <code>refresh_token</code> vides.</p>
<p>Si la requête est réussie :</p>
<ul>
<li>Les données d&#x27;utilisateur stockées dans <code>localStorage</code> sont effacées.</li>
<li>L&#x27;observable <code>AuthenticatedUser$</code> est mis à jour avec la valeur <code>null</code>, indiquant que l&#x27;utilisateur est déconnecté.</li>
<li>L&#x27;utilisateur est redirigé vers la page de connexion (<code>/login</code>)</li>
</ul>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token function" style="color:#d73a49">logout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;post&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;http://localhost:8086/api/v1/auth/logout&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      withCredentials</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function-variable function" style="color:#d73a49">next</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">storageService</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">clean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AuthenticatedUser$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">router</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">navigate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;/login&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="création-du-service-user">Création du service User<a href="#création-du-service-user" class="hash-link" aria-label="Lien direct vers Création du service User" title="Lien direct vers Création du service User">​</a></h3>
<p>Dans l&#x27;API et dans notre <code>AuthorizationController</code>, nous avons deux end-points qui affichent un message en fonction des permissions et du rôle de l&#x27;utilisateur.</p>
<p><img decoding="async" loading="lazy" alt="image-20231017165513726" src="/assets/images/image-20231017165513726-ae3c025c2b8f7a4d8f19814c5c8349db.png" width="924" height="112" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="image-20231017165642243" src="/assets/images/image-20231017165642243-51776736923fe25e94df292ffb320071.png" width="926" height="113" class="img_ev3q"></p>
<p>Le service <code>userService</code> permet de les invoquer :</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> Injectable </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@angular/core&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">HttpClient</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;@angular/common/http&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator at operator" style="color:#393A34">@</span><span class="token decorator function" style="color:#d73a49">Injectable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  providedIn</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;root&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">UserService</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">constructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> http </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> HttpClient</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">getUserPublicContent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain">  </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;post&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;http://localhost:8086/api/v1/user/resource&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      withCredentials</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      responseType </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">getAdminPublicContent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain">  </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;get&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;http://localhost:8086/api/v1/admin/resource&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      withCredentials</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      responseType </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="création-de-la-page-home">Création de la page Home<a href="#création-de-la-page-home" class="hash-link" aria-label="Lien direct vers Création de la page Home" title="Lien direct vers Création de la page Home">​</a></h3>
<p>Le composant <code>HomeComponent</code> est responsable de l&#x27;affichage de la page d&#x27;accueil de l&#x27;application. Il interagit avec le service <code>UserService</code> pour récupérer le message renvoyé par <code> getUserPublicContent()</code>  et avec  <code>AuthService</code>, pour récupérer les informations de l&#x27;utilisateur connecté.</p>
<p><strong>home.component.ts</strong></p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Component</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> OnDestroy</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> OnInit</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@angular/core&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">UserService</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;../_services/user.service&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">AuthService</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;../_services/auth.service&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">User</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;../_models/user.model&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Subscription</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;rxjs&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator at operator" style="color:#393A34">@</span><span class="token decorator function" style="color:#d73a49">Component</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  selector</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;app-home&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  templateUrl</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;./home.component.html&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  styleUrls</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;./home.component.scss&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">HomeComponent</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">OnInit</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> OnDestroy </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pubContent </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  user</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> User</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AuthUserSub</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Subscription</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">constructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> userService </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> UserService</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> authService </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> AuthService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">ngOnInit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AuthUserSub </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">authService</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AuthenticatedUser$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function-variable function" style="color:#d73a49">next</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> user </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">user </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">userService</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getUserPublicContent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function-variable function" style="color:#d73a49">next</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> data </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pubContent </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function-variable function" style="color:#d73a49">error</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">ngOnDestroy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AuthUserSub</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">unsubscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>home.component.html</strong></p>
<p>Il sert principalement à afficher la barre de navigation (<code>&lt;app-header&gt;&lt;/app-header&gt;</code>, qui inclut le composant <code>HeaderComponent</code>), ainsi que les informations récupérées.</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">app-header</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">app-header</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">container</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">row m-5</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">col</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">card</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">card-header</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          Connected user information :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">card-body</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">*ngIf</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">user</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">ID: {{user.id}}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Email: {{user.email}}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Role: {{user.role.name}} </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">strong</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Permissions:</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">strong</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">ul</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">li</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">*ngFor</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">let p of user.role.permissions</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {{ p }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">li</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">ul</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          Message :</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">{{pubContent}}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="création-de-la-page-admin">Création de la page Admin<a href="#création-de-la-page-admin" class="hash-link" aria-label="Lien direct vers Création de la page Admin" title="Lien direct vers Création de la page Admin">​</a></h3>
<p>La page admin, accessible uniquement par l&#x27;utilisateur disposant du rôle admin, permet d&#x27;afficher le message renvoyé par la méthode <code>getAdminPublicContent()</code> du service <code>userService</code>.</p>
<p><strong>admin.components.ts</strong></p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Component</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> OnInit</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@angular/core&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">UserService</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;../_services/user.service&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator at operator" style="color:#393A34">@</span><span class="token decorator function" style="color:#d73a49">Component</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  selector</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;app-admin&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  templateUrl</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;./admin.component.html&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  styleUrls</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;./admin.component.scss&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">AdminComponent</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">OnInit</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  adminPubContent</span><span class="token operator" style="color:#393A34">!</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">constructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> userService </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> UserService</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">ngOnInit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">userService</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getAdminPublicContent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function-variable function" style="color:#d73a49">next</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> data </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">adminPubContent </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function-variable function" style="color:#d73a49">error</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>admin.components.html</strong></p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">app-header</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">app-header</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">container mt-5</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">row justify-content-center</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">col-md-6</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">card</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">card-header</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Admin Dashboard</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">card-body</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">*ngIf</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">adminPubContent</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">{{adminPubContent}}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="implémentation-de-la-méthode-refreshtoken-dans-le-service-authservice">Implémentation de la méthode refreshToken dans le service authService<a href="#implémentation-de-la-méthode-refreshtoken-dans-le-service-authservice" class="hash-link" aria-label="Lien direct vers Implémentation de la méthode refreshToken dans le service authService" title="Lien direct vers Implémentation de la méthode refreshToken dans le service authService">​</a></h3>
<p>Ajoutez la méthode refreshToken au service <code>authService</code> :</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">refreshToken</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;post&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://localhost:8086/api/v1/auth/refresh-token-cookie&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      withCredentials</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Pour demander un nouveau <code>access_token</code>, nous pouvons simplement envoyer une requête vers l&#x27;endpoint <code>api/v1/auth/refresh-token-cookie</code> avec l&#x27;option <code>withCredentials: true</code>. L&#x27;API va recevoir les cookies HTTP-only <code>access_token</code> et <code>refresh_token</code>, et en fonction de la validité du <code>refresh_token</code>, l&#x27;API va renvoyer soit un nouveau <code>access_token</code> avec un code HTTP 200, soit une erreur avec un code HTTP 403.</p>
<p>Et si nous recevons une erreur 403, dans ce cas, il est nécessaire de déconnecter l&#x27;utilisateur. Pour ce faire, nous utilisons les intercepteurs HTTP.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="gestion-des-erreurs-avec-les-intercepteurs-http-angular">Gestion des Erreurs avec les Intercepteurs HTTP Angular<a href="#gestion-des-erreurs-avec-les-intercepteurs-http-angular" class="hash-link" aria-label="Lien direct vers Gestion des Erreurs avec les Intercepteurs HTTP Angular" title="Lien direct vers Gestion des Erreurs avec les Intercepteurs HTTP Angular">​</a></h3>
<p>L&#x27;intercepteur joue un rôle essentiel dans la gestion de l&#x27;authentification et de la sécurité au sein de notre application Angular. Il est responsable de l&#x27;interception de toutes les requêtes HTTP sortantes.</p>
<p>Notre objectif principal est de gérer les requêtes en fonction du contexte de l&#x27;utilisateur authentifié. Lorsqu&#x27;un utilisateur est authentifié, l&#x27;intercepteur est configuré pour réagir de la manière suivante en cas d&#x27;erreur HTTP :</p>
<ol>
<li>Pour une erreur <strong>403 (accès refusé)</strong> : Cela signifie que l&#x27;utilisateur n&#x27;a pas l&#x27;autorisation d&#x27;accéder à une ressource particulière. Par exemple, si un utilisateur avec le rôle &quot;user&quot; tente d&#x27;accéder directement à la page admin en saisissant l&#x27;URL &quot;/admin,&quot; l&#x27;intercepteur empêche l&#x27;accès.</li>
<li>Pour une erreur <strong>401 (non autorisé)</strong> : Cela indique que le token  <code>access_token</code> a expiré, ce qui signifie que l&#x27;utilisateur n&#x27;a plus accès. Dans ce cas, l&#x27;intercepteur tente de rafraîchir le token en appelant la méthode <code>refreshToken()</code> du service <code>AuthService</code>.<!-- -->
<ul>
<li>Si le rafraîchissement réussit, la requête est renvoyée avec le nouveau <code>access_token</code>.</li>
<li>Si le rafraîchissement échoue, par exemple avec une erreur 403 (accès refusé), l&#x27;utilisateur est déconnecté car le <code>refresh_token</code> est invalide.</li>
</ul>
</li>
</ol>
<p>Enfin, pour toutes les autres erreurs inattendues, elles sont renvoyées au service appelant afin d&#x27;être traitées ultérieurement.</p>
<p>Voici le code de l&#x27;intercepteur :</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> Injectable </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@angular/core&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  HttpRequest</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  HttpHandler</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  HttpEvent</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> HttpErrorResponse</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@angular/common/http&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">catchError</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> concatMap</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Observable</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> switchMap</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> take</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> throwError</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;rxjs&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">AuthService</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;../_services/auth.service&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Router</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;@angular/router&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator at operator" style="color:#393A34">@</span><span class="token decorator function" style="color:#d73a49">Injectable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">HttpInterceptor</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">HttpInterceptor</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">constructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> authService</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> AuthService</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> router</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Router</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">intercept</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> HttpRequest</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token builtin">unknown</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> next</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> HttpHandler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Observable</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">HttpEvent</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token builtin">unknown</span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">authService</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AuthenticatedUser$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">take</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">switchMap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> next</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">handle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> next</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">handle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token function" style="color:#d73a49">catchError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err </span><span class="token keyword" style="color:#00009f">instanceof</span><span class="token plain"> </span><span class="token class-name">HttpErrorResponse</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token keyword" style="color:#00009f">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">status</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">403</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">router</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">navigate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;forbidden&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">401</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// handle 401 unauthorized error : try to refresh JWT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">authService</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">refreshToken</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token function" style="color:#d73a49">concatMap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> next</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">handle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token function" style="color:#d73a49">catchError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">status </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">403</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">authService</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">logout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">throwError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">throwError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>next.handle(request)</code> est un observable qui représente une requête HTTP asynchrone, et <code>this.authService.refreshToken()</code> est également un observable, utilisé pour effectuer un rafraîchissement asynchrone de l&#x27;<code>access_token</code>.</p>
<p>Il est donc essentiel de gérer les opérations asynchrones de manière contrôlée.</p>
<p>Le choix d&#x27;utiliser l&#x27;opérateur <code>switchMap</code> était pertinent en raison de l&#x27;observable <code>this.authService.AuthenticatedUser$</code>, qui n&#x27;émet qu&#x27;une seule valeur grâce à <code>take(1)</code>. Avec <code>switchMap</code>, toute nouvelle valeur émise par cet observable annule automatiquement les requêtes HTTP en cours, garantissant ainsi un changement instantané lorsque l&#x27;état d&#x27;authentification de l&#x27;utilisateur change.</p>
<p><code>concatMap</code> est utilisé pour maintenir l&#x27;ordre des requêtes, assurant que les requêtes HTTP sont gérées de manière séquentielle. Cela garantit que <code>next.handle(request)</code> ne sera exécuté qu&#x27;une fois que <code>this.authService.refreshToken()</code> est terminé.</p>
<p>Enfin déclarez l&#x27;intercepteur dans <code>app.module.ts</code> pour qu&#x27;il soit utilisé par l&#x27;application :</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  providers</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">provide </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">HTTP_INTERCEPTORS</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> useClass </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> HttpInterceptor</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> multi</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>L&#x27;option <code>multi: true</code> permet d&#x27;ajouter cet intercepteur à la liste d&#x27;intercepteurs HTTP, car il peut y en avoir plusieurs. Si elle est définie sur <code>false</code>, cela remplacerait tous les intercepteurs existants au lieu d&#x27;en ajouter un de plus.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="création-du-composant-access-denied">Création du composant access-denied<a href="#création-du-composant-access-denied" class="hash-link" aria-label="Lien direct vers Création du composant access-denied" title="Lien direct vers Création du composant access-denied">​</a></h3>
<p>Le composant <code>access-denied</code> affiche simplement un message d&#x27;erreur avec un bouton permettant de rediriger l&#x27;utilisateur vers la page Home.</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">d-flex align-items-center justify-content-center vh-100</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">text-center</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">h1</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">display-1 fw-bold</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">403</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">h1</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">fs-3</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">span</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">text-danger</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Oops!</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">span</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"> Access Denied.</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">lead</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      The page you&#x27;re trying to access is restricted.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">a</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">href</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">routerLink</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">/home</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">btn btn-primary</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Go Home</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">a</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mise-en-place-de-lauto-login">Mise en place de l&#x27;auto-login<a href="#mise-en-place-de-lauto-login" class="hash-link" aria-label="Lien direct vers Mise en place de l&#x27;auto-login" title="Lien direct vers Mise en place de l&#x27;auto-login">​</a></h3>
<p>L&#x27;auto-login, ou &quot;authentification automatique,&quot; est en effet un mécanisme qui permet à un utilisateur d&#x27;être reconnecté automatiquement à une application sans avoir à saisir manuellement ses identifiants (comme son email et son mot de passe) à chaque visite ultérieure. Ce mécanisme améliore l&#x27;expérience utilisateur en rendant le processus d&#x27;authentification plus transparent et pratique.</p>
<p>Techniquement, dans notre application Angular, si l&#x27;utilisateur quitte son navigateur ou son onglet sans se déconnecter et qu&#x27;il revient ultérieurement, nous pouvons le reconnecter automatiquement en utilisant les informations stockées dans le <code>localStorage</code>.</p>
<p>Ajoutez la méthode <code>autoLogin()</code> dans le service <code>authService</code> :</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">autoLogin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> userData </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">storageService</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getSavedUser</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">userData</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AuthenticatedUser$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">userData</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>La méthode <code>autoLogin()</code> restaure automatiquement l&#x27;état d&#x27;authentification de l&#x27;utilisateur en utilisant l&#x27;objet User préalablement sauvegardé dans le <code>localStorage</code> et l&#x27;émet dans <code>AuthenticatedUser$</code>.</p>
<p>Elle doit être appelée au démarrage de l&#x27;application, de préférence dans le composant racine <code>AppComponent</code>. Cela garantit que l&#x27;état d&#x27;authentification de l&#x27;utilisateur est restauré dès le chargement de l&#x27;application :</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Component</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> OnInit</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@angular/core&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">AuthService</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./_services/auth.service&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator at operator" style="color:#393A34">@</span><span class="token decorator function" style="color:#d73a49">Component</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  selector</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;app-root&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  templateUrl</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;./app.component.html&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  styleUrls</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;./app.component.scss&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">AppComponent</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">OnInit</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  title </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;angular-auth&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">constructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> authService </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> AuthService</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">ngOnInit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">authService</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">autoLogin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Veuillez noter que si l&#x27;<code>access_token</code> expire, l&#x27;intercepteur tentera automatiquement de demander un nouveau. Si cette tentative échoue, l&#x27;utilisateur sera redirigé vers la page login où il devra se reconnecter. Cette situation peut être considérée comme une forme d&#x27;auto-login, car l&#x27;utilisateur est redirigé vers la page login pour obtenir un nouveau <code>access_token</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="démonstration">Démonstration<a href="#démonstration" class="hash-link" aria-label="Lien direct vers Démonstration" title="Lien direct vers Démonstration">​</a></h2>
<p>Échec de la connexion</p>
<p><img decoding="async" loading="lazy" alt="image-20231018144534277" src="data:image/png;base64,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" width="360" height="326" class="img_ev3q"></p>
<p>Exemple d&#x27;authentification réussie avec un utilisateur ayant le rôle USER, la page home s&#x27;affiche par défaut.</p>
<p>La barre de navigation n&#x27;affiche que l&#x27;onglet Home.</p>
<p><img decoding="async" loading="lazy" alt="image-20231018144918466" src="/assets/images/image-20231018144918466-c17f0f64298abac90b69fd0ff8de0ead.png" width="861" height="371" class="img_ev3q"></p>
<p>Deux requêtes sont envoyées à l&#x27;API avec un code HTTP 200 : la première est pour l&#x27;authentification, la deuxième est pour récupérer le message à partir de l&#x27;end-point sécurisé.</p>
<p><img decoding="async" loading="lazy" alt="image-20231018145039994" src="/assets/images/image-20231018145039994-6823707cefe8d00cbf663356c51686e6.png" width="801" height="298" class="img_ev3q"></p>
<p>Dans la réponse de la requête d&#x27;authentification, nous pouvons constater que nous avons bien reçu les cookies envoyés par l&#x27;API.</p>
<p><img decoding="async" loading="lazy" alt="image-20231018145415340" src="/assets/images/image-20231018145415340-07d225531fcbc5de69433fbd754761f1.png" width="1118" height="589" class="img_ev3q"></p>
<p>Dans la requête demandant l&#x27;accès à l&#x27;end-point sécurisé, nous pouvons clairement voir que notre application Angular a inclus les cookies contenant les <code>access_token</code> et <code>refresh_token</code>.</p>
<p><img decoding="async" loading="lazy" alt="image-20231018145633521" src="/assets/images/image-20231018145633521-2d1af888d6c9ffb4b3b963e37e7298ab.png" width="1120" height="587" class="img_ev3q"></p>
<p>Nous pouvons également observer que les cookies sont stockés dans le navigateur avec les options HttpOnly, Secure et SameSite strict.</p>
<p><img decoding="async" loading="lazy" alt="image-20231018145839650" src="/assets/images/image-20231018145839650-984e4816e658b230698a2cbff5d484f1.png" width="1118" height="402" class="img_ev3q"></p>
<p>Les informations de l&#x27;utilisateur authentifié sont également bien enregistrées dans le <code>localStorage</code>.</p>
<p><img decoding="async" loading="lazy" alt="image-20231018145946686" src="/assets/images/image-20231018145946686-c6c95eaca28d350efbd1df05e9a36341.png" width="1113" height="341" class="img_ev3q"></p>
<p>Si l&#x27;<code>access_token</code> a expiré et que l&#x27;utilisateur a interagi avec l&#x27;application (dans ce cas, en actualisant la page Home), nous pouvons constater que la requête visant à récupérer le message depuis l&#x27;end-point sécurisé a échoué avec un code HTTP 401. À ce moment, l&#x27;intercepteur a envoyé une deuxième requête pour actualiser l&#x27;<code>access_token</code>, et la réponse était accompagnée d&#x27;un code HTTP 200. La navigation se poursuit sans demander à l&#x27;utilisateur de se reconnecter.</p>
<p><img decoding="async" loading="lazy" alt="image-20231018160146964" src="/assets/images/image-20231018160146964-25bc61fcb97bb30a8d44578da0b9bb6a.png" width="1111" height="523" class="img_ev3q"></p>
<p>Si le <code>refresh_token</code> n&#x27;est plus valide, nous pouvons voir que la réponse de la requête de rafraîchissement arrive avec le code HTTP 403. Dans ce cas, l&#x27;utilisateur est déconnecté automatiquement et redirigé vers la page login.</p>
<p><img decoding="async" loading="lazy" alt="image-20231018161030539" src="/assets/images/image-20231018161030539-cb56cf0f5510e880753cee59d8f9e2b9.png" width="1115" height="476" class="img_ev3q"></p>
<p><strong>Remarque</strong> : Pour éviter d&#x27;attendre l&#x27;expiration de l&#x27;<code>access_token</code>, du <code>refresh_token</code>, vous pouvez simplement les supprimer. Cela vous permettra de simuler les tests que nous avons effectués à chaque étape.</p>
<p>Si l&#x27;utilisateur tente d&#x27;accéder à la page admin en tapant directement l&#x27;URL <code>/admin</code> :</p>
<p><img decoding="async" loading="lazy" alt="image-20231018160322594" src="/assets/images/image-20231018160322594-ebb11d6ea374b1d27f84090dad48313f.png" width="770" height="369" class="img_ev3q"></p>
<p>Exemple d&#x27;authentification réussie avec un utilisateur ayant le rôle ADMIN.</p>
<p>Cette fois, nous pouvons constater qu&#x27;un nouvel onglet <code>Admin Board</code> s&#x27;affiche dans la barre de navigation.</p>
<p><img decoding="async" loading="lazy" alt="image-20231018161314142" src="/assets/images/image-20231018161314142-8dadeb0447b5b5e8fb10d975a97a4b95.png" width="856" height="437" class="img_ev3q"></p>
<p>Voici le contenu de la page de connexion, qui affiche simplement le message récupéré depuis l&#x27;end-point sécurisé.</p>
<p><img decoding="async" loading="lazy" alt="image-20231018161403580" src="data:image/png;base64,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" width="860" height="439" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="code-source-de-lapplication">Code source de l&#x27;application<a href="#code-source-de-lapplication" class="hash-link" aria-label="Lien direct vers Code source de l&#x27;application" title="Lien direct vers Code source de l&#x27;application">​</a></h2>
<p>Voici le lien vers le code source de l&#x27;application : <a href="https://github.com/MossaabFrifita/angular-16-jwt-authentication-authorization" target="_blank" rel="noopener noreferrer">https://github.com/MossaabFrifita/angular-16-jwt-authentication-authorization</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Lien direct vers Conclusion" title="Lien direct vers Conclusion">​</a></h2>
<p>La gestion de l&#x27;authentification est un élément essentiel de toute application web sécurisée, et grâce aux connaissances acquises dans cet article, vous serez en mesure de développer des applications Angular plus sûres et plus fiables. Bonne mise en œuvre de l&#x27;authentification dans vos projets !</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags :</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/angular-16">Angular16</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/jwt">JWT</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/refresh-token">RefreshToken</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/authentification">Authentification</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/autorisation">Autorisation</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/http-only-cookies">HttpOnlyCookies</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/role-based-access-control">RoleBasedAccessControl</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Pages de documentation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/category/angular"><div class="pagination-nav__sublabel">Précédent</div><div class="pagination-nav__label">Angular</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#quel-est-le-meilleur-endroit-pour-stocker-les-tokens-côté-client-" class="table-of-contents__link toc-highlight">Quel est le meilleur endroit pour stocker les tokens Côté Client ?</a></li><li><a href="#lavantage-du-cookie-http-only-avec-securetrue-et-samesitestrict" class="table-of-contents__link toc-highlight">L&#39;Avantage du Cookie HTTP Only avec Secure=true et SameSite=Strict</a></li><li><a href="#modification-de-lapi-spring-boot-pour-intégrer-la-gestion-de-cookies-en-session-http-only" class="table-of-contents__link toc-highlight"><strong>Modification de l&#39;API Spring Boot pour Intégrer la Gestion de Cookies en Session HTTP Only</strong></a><ul><li><a href="#modification-du-jwtservice-et-du-refreshtokenservice" class="table-of-contents__link toc-highlight">Modification du JwtService et du refreshTokenService</a></li><li><a href="#intégration-de-la-récupération-du-cookie-jwt-dans-le-filtre-jwtauthenticationfilter" class="table-of-contents__link toc-highlight">Intégration de la récupération du Cookie JWT dans le Filtre JwtAuthenticationFilter</a></li><li><a href="#modification-du-contrôleur-authenticationcontroller" class="table-of-contents__link toc-highlight">Modification du contrôleur AuthenticationController</a></li></ul></li><li><a href="#implémentation-de-lauthentification-et-de-lautorisation-dans-angular-16" class="table-of-contents__link toc-highlight">Implémentation de l&#39;Authentification et de l&#39;Autorisation dans Angular 16</a><ul><li><a href="#création-du-projet-angular" class="table-of-contents__link toc-highlight">Création du projet Angular</a></li><li><a href="#création-des-modèles-user-et-role" class="table-of-contents__link toc-highlight">Création des modèles User et Role</a></li><li><a href="#création-du-service-storage" class="table-of-contents__link toc-highlight">Création du service Storage</a></li><li><a href="#comprendre-le-mécanisme-dauthentification-avec-des-cookies-http-only" class="table-of-contents__link toc-highlight">Comprendre le mécanisme d&#39;authentification avec des cookies HTTP-only</a></li><li><a href="#création-du-service-authentification" class="table-of-contents__link toc-highlight">Création du service Authentification</a></li><li><a href="#module-de-routage-dapplication" class="table-of-contents__link toc-highlight">Module de routage d&#39;application</a></li><li><a href="#garde-dauthentification" class="table-of-contents__link toc-highlight">Garde d&#39;authentification</a></li><li><a href="#création-de-la-page-login" class="table-of-contents__link toc-highlight">Création de la page login</a></li><li><a href="#création-dune-barre-de-navigation-dynamique" class="table-of-contents__link toc-highlight">Création d&#39;une barre de navigation dynamique</a></li><li><a href="#implémentation-de-la-méthode-logout-dans-le-service-authservice" class="table-of-contents__link toc-highlight">Implémentation de la méthode logout dans le service authService</a></li><li><a href="#création-du-service-user" class="table-of-contents__link toc-highlight">Création du service User</a></li><li><a href="#création-de-la-page-home" class="table-of-contents__link toc-highlight">Création de la page Home</a></li><li><a href="#création-de-la-page-admin" class="table-of-contents__link toc-highlight">Création de la page Admin</a></li><li><a href="#implémentation-de-la-méthode-refreshtoken-dans-le-service-authservice" class="table-of-contents__link toc-highlight">Implémentation de la méthode refreshToken dans le service authService</a></li><li><a href="#gestion-des-erreurs-avec-les-intercepteurs-http-angular" class="table-of-contents__link toc-highlight">Gestion des Erreurs avec les Intercepteurs HTTP Angular</a></li><li><a href="#création-du-composant-access-denied" class="table-of-contents__link toc-highlight">Création du composant access-denied</a></li><li><a href="#mise-en-place-de-lauto-login" class="table-of-contents__link toc-highlight">Mise en place de l&#39;auto-login</a></li></ul></li><li><a href="#démonstration" class="table-of-contents__link toc-highlight">Démonstration</a></li><li><a href="#code-source-de-lapplication" class="table-of-contents__link toc-highlight">Code source de l&#39;application</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/category/devops-cicd-pipeline">Articles</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/mossaab-frifita-17ba44138" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/MossaabFrifita" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Mossaab Frifita. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>