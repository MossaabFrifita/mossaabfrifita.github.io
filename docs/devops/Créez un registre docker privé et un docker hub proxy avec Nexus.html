<!doctype html>
<html lang="fr" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-devops/Créez un registre docker privé et un docker hub proxy avec Nexus" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Créez un registre docker privé et un docker hub proxy avec Nexus | ON APPREND SANS CESSE</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://mossaabfrifita.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://mossaabfrifita.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://mossaabfrifita.github.io/docs/devops/Créez un registre docker privé et un docker hub proxy avec Nexus"><meta data-rh="true" property="og:locale" content="fr"><meta data-rh="true" name="docusaurus_locale" content="fr"><meta data-rh="true" name="docsearch:language" content="fr"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Créez un registre docker privé et un docker hub proxy avec Nexus | ON APPREND SANS CESSE"><meta data-rh="true" name="description" content="Au lieu de stocker nos images Docker privées générées lors des builds sur un registry public tel que Docker Hub, nous allons mettre en place un registry privé avec Nexus (docker hosted). Nous allons également en profiter pour créer un proxy vers le Docker Hub public (docker proxy). Un dépôt proxy Docker dans Nexus agit comme un intermédiaire entre notre environnement de développement (ou CI/CD) et Docker Hub. Nexus stocke localement les images Docker provenant de Docker Hub, réduisant ainsi le temps de téléchargement en cas de demandes répétées et permet aux développeurs d&#x27;accéder plus rapidement aux dépendances nécessaires à leurs projets."><meta data-rh="true" property="og:description" content="Au lieu de stocker nos images Docker privées générées lors des builds sur un registry public tel que Docker Hub, nous allons mettre en place un registry privé avec Nexus (docker hosted). Nous allons également en profiter pour créer un proxy vers le Docker Hub public (docker proxy). Un dépôt proxy Docker dans Nexus agit comme un intermédiaire entre notre environnement de développement (ou CI/CD) et Docker Hub. Nexus stocke localement les images Docker provenant de Docker Hub, réduisant ainsi le temps de téléchargement en cas de demandes répétées et permet aux développeurs d&#x27;accéder plus rapidement aux dépendances nécessaires à leurs projets."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://mossaabfrifita.github.io/docs/devops/Créez un registre docker privé et un docker hub proxy avec Nexus"><link data-rh="true" rel="alternate" href="https://mossaabfrifita.github.io/docs/devops/Créez un registre docker privé et un docker hub proxy avec Nexus" hreflang="fr"><link data-rh="true" rel="alternate" href="https://mossaabfrifita.github.io/docs/devops/Créez un registre docker privé et un docker hub proxy avec Nexus" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.ea9770ca.css">
<script src="/assets/js/runtime~main.afe266ae.js" defer="defer"></script>
<script src="/assets/js/main.0cd224c4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Aller au contenu principal"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Aller au contenu principal</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Ouvrir/fermer la barre de navigation" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/custom-logo.jpg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/custom-logo.jpg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Mossaab Frifita</b></a><a class="navbar__item navbar__link" href="/docs/category/devops-cicd-pipeline">DevOps</a><a class="navbar__item navbar__link" href="/docs/category/spring-framework">Spring</a><a class="navbar__item navbar__link" href="/docs/category/angular">Angular</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/MossaabFrifita" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Basculer entre le mode sombre et clair (actuellement mode clair)" aria-label="Basculer entre le mode sombre et clair (actuellement mode clair)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Retour au début de la page" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/devops-cicd-pipeline">DevOps CI/CD pipeline</a><button aria-label="Réduire la catégorie &#x27;DevOps CI/CD pipeline&#x27; de la barre latérale" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/devops/Ce que vous apprendrez">Ce que vous apprendrez</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/devops/Créez votre environnement de travail">Créez votre environnement de travail</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/devops/Installez et configurez Docker">Installez et configurez Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/devops/Créez une simple application Spring Boot">Créez une simple application Spring Boot</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/devops/Installation et configuration de SonarQube et JaCoCo">Installation et configuration de SonarQube et JaCoCo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/devops/Conteneurisez l&#x27;application Spring Boot avec Docker">Conteneurisez l&#x27;application Spring Boot avec Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/devops/Créez un registre docker privé et un docker hub proxy avec Nexus">Créez un registre docker privé et un docker hub proxy avec Nexus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/devops/Utilisez Ansible pour automatiser le déploiement de votre application">Utilisez Ansible pour automatiser le déploiement de votre application</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/devops/Gérez le Versioning en livraison continue">Gérez le Versioning en livraison continue</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/devops/Construisez un pipeline CI-CD avec Jenkins">Construisez un pipeline CI-CD avec Jenkins</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/spring-framework">Spring Framework</a><button aria-label="Développer la catégorie &#x27;Spring Framework&#x27; de la barre latérale" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/angular">Angular</a><button aria-label="Développer la catégorie &#x27;Angular&#x27; de la barre latérale" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Fil d&#x27;Ariane"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Page d&#x27;accueil" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/devops-cicd-pipeline"><span itemprop="name">DevOps CI/CD pipeline</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Créez un registre docker privé et un docker hub proxy avec Nexus</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Sur cette page</button></div><div class="theme-doc-markdown markdown"><header><h1>Créez un registre docker privé et un docker hub proxy avec Nexus</h1></header><p>Au lieu de stocker nos images Docker privées générées lors des builds sur un registry public tel que Docker Hub, nous allons mettre en place un registry privé avec Nexus (docker hosted). Nous allons également en profiter pour créer un proxy vers le Docker Hub public (docker proxy). Un dépôt proxy Docker dans Nexus agit comme un intermédiaire entre notre environnement de développement (ou CI/CD) et Docker Hub. Nexus stocke localement les images Docker provenant de Docker Hub, réduisant ainsi le temps de téléchargement en cas de demandes répétées et permet aux développeurs d&#x27;accéder plus rapidement aux dépendances nécessaires à leurs projets.</p>
<p>Nous mettons donc en place deux registres avec Nexus :</p>
<ol>
<li>Un registre d&#x27;images Docker privé</li>
<li>Un registre Docker public pour accélérer les pulls</li>
</ol>
<p>Voici le principe de fonctionnement expliqué avec le diagramme ci-dessous :</p>
<p><img decoding="async" loading="lazy" alt="concept.drawio" src="/assets/images/concept.drawio-3b1328cc69744fc38ccc736a0e93c92a.png" width="491" height="409" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="installez-nexus-repository-manager">Installez Nexus Repository Manager<a href="#installez-nexus-repository-manager" class="hash-link" aria-label="Lien direct vers Installez Nexus Repository Manager" title="Lien direct vers Installez Nexus Repository Manager">​</a></h2>
<p>Nous allons installer Nexus dans un conteneur Docker avec <code>Docker compose</code> dans la VM <code>masterserver</code></p>
<p>Le Docker Compose est un fichier YAML, contrairement au Dockerfile. Il permet de décrire l&#x27;ensemble de la configuration de l&#x27;application, les relations entre les images Docker, ainsi que l&#x27;ordre de démarrage de ces dernières.</p>
<p>Créez un fichier docker-compose.yaml dans votre espace de travail sur la machine hôte ou directement sur <code>masterserver</code>. Si vous souhaitez créer le fichier sur votre machine hôte, tout comme avec Docker CLI, installez Docker Compose.</p>
<p>Sur Windows, vous pouvez l&#x27;installer avec Chocolatey</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">choco install docker-compose</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Voici le contenu du fichier Docker Compose :</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;3.7&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">services</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">nexus</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sonatype/nexus3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">expose</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8081</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8082</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8083</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">restart</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;nexus-work:/sonatype-work&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;5001:8081&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;5002:8082&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;5003:8083&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">nexus-work</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Les ports exposés sont les suivants :</p>
<ul>
<li>8081 : le port par défaut de Nexus pour accéder à son interface graphique.</li>
<li>8082 : le port que nous allons choisir pour le registre public.</li>
<li>8083 : le port que nous allons choisir pour le registre privé.</li>
</ul>
<p>Ces ports du conteneur (8081, 8082 et 8083) sont mappés sur les ports 5001, 5002 et 5003 de la machine hôte (<code>masterserver</code>), respectivement. Vous êtes libre de choisir d&#x27;autres ports en fonction de leur disponibilité et de vos préférences !</p>
<p>Le volume &quot;nexus-work&quot; est monté sur le chemin &quot;/sonatype-work&quot; à l&#x27;intérieur du conteneur. Cela permet de persister les données générées par Nexus, comme les artefacts et la configuration.</p>
<p>Placez-vous à la racine du dossier où vous avez créé votre fichier Docker Compose et exécutez la commande suivante :</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker compose up -d</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Faites un <code>docker ps</code> pour vérifier que le conteneur est en cours d&#x27;exécution et que les ports sont correctement mappés :</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">E:\workspace\dockerize\sonatype-nexus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">λ docker ps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CONTAINER ID   IMAGE                             COMMAND                  CREATED       STATUS      PORTS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               NAMES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bbe83eb3d218   sonatype/nexus3                   &quot;/opt/sonatype/nexus…&quot;   6 days ago    Up 5 days   0.0.0.0:5001-&gt;8081/tcp, :::5001-&gt;8081/tcp, 0.0.0.0:5002-&gt;8082/tcp, :::5002-&gt;8082/tcp, 0.0.0.0:5003-&gt;8083/tcp, :::5003-&gt;8083/tcp   sonatype-nexus-nexus-1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Accédez à l&#x27;interface web de Nexus depuis votre navigateur via l&#x27;adresse <code>prod.local:5001</code>.</p>
<p><img decoding="async" loading="lazy" alt="image-20240106125224705" src="/assets/images/image-20240106125224705-6c8e55a6ca00123bcb00a396da29874b.png" width="977" height="561" class="img_ev3q"></p>
<p>Cliquez sur &quot;Sign in&quot; pour vous authentifier. Le compte administrateur est créé automatiquement. Le nom d&#x27;utilisateur est <code>admin</code> et le mot de passe se trouve dans le fichier <code>/nexus-data/admin.password</code>.</p>
<p>Pour l&#x27;afficher tapez cette commande dans <code>masterserver</code> qui permet d&#x27;exécuter la commande cat à l&#x27;intérieur du conteneur nexus:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker exec -i sonatype-nexus-nexus-1 cat /nexus-data/admin.password</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configurez-docker-pour-accepter-les-registres-non-sécurisés">Configurez docker pour accepter les registres non sécurisés<a href="#configurez-docker-pour-accepter-les-registres-non-sécurisés" class="hash-link" aria-label="Lien direct vers Configurez docker pour accepter les registres non sécurisés" title="Lien direct vers Configurez docker pour accepter les registres non sécurisés">​</a></h2>
<p>Par défaut, Docker n&#x27;accepte pas la communication avec des registres non sécurisés, c&#x27;est-à-dire via HTTP. Cependant, notre domaine local <code>prod.local</code> utilise uniquement le protocole HTTP. Par conséquent, nous devons configurer Docker pour lui permettre de communiquer avec des registres non sécurisés.</p>
<p>Nous allons créer deux registres : le registre public, qui utilise le port <code>5002</code> de notre machine hôte, et le registre privé, qui utilise le port <code>5003</code>.</p>
<p>Vous allez donc ajouter l&#x27;adresse de ces deux registres à la liste des &quot;insecure-registries&quot; dans la configuration de Docker. Cela informe Docker qu&#x27;il peut se connecter à ces registres sans utiliser HTTPS.</p>
<p>La liste des registres non sécurisés peut être ajoutée sous format JSON dans le fichier <code>/etc/docker/daemon.json</code> :</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@masterserver:/# cat /etc/docker/daemon.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;insecure-registries&quot; : [&quot;http://prod.local:5002&quot;,&quot;http://prod.local:5003&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Enregistrez le fichier et redémarrez le service docker</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl daemon-reload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl restart docker</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Petite information : pour vos propres serveurs et si vous avez un vrai nom de domaine enregistré, vous pouvez utiliser &quot;Let&#x27;s Encrypt&quot; pour obtenir des certificat SSL/TLS gratuit !</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="créez-un-docker-hub-proxy">Créez un docker hub proxy<a href="#créez-un-docker-hub-proxy" class="hash-link" aria-label="Lien direct vers Créez un docker hub proxy" title="Lien direct vers Créez un docker hub proxy">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="créez-un-stockage-blob-pour-le-registre-privé">Créez un stockage blob pour le registre privé<a href="#créez-un-stockage-blob-pour-le-registre-privé" class="hash-link" aria-label="Lien direct vers Créez un stockage blob pour le registre privé" title="Lien direct vers Créez un stockage blob pour le registre privé">​</a></h3>
<p>Le stockage blob permet de stocker les images docker.</p>
<ol>
<li>
<p>Cliquez sur l&#x27;icône de configuration (engrenage).</p>
</li>
<li>
<p>Accédez à &quot;Blob Stores&quot;.</p>
</li>
<li>
<p>Créez un nouveau Blob Store de type &quot;File&quot;.</p>
</li>
<li>
<p>Vous pouvez lui donner le nom de votre choix, mais un bon choix est &quot;docker-hub&quot;.</p>
</li>
<li>
<p>Cliquez sur &quot;Save&quot;.</p>
<p><img decoding="async" loading="lazy" alt="image-20240106174647326" src="/assets/images/image-20240106174647326-6d96f89ba85841fadca6322e74c673ea.png" width="513" height="704" class="img_ev3q"></p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="activez-docker-bearer-token-relam">Activez &quot;Docker Bearer Token Relam&quot;<a href="#activez-docker-bearer-token-relam" class="hash-link" aria-label="Lien direct vers Activez &quot;Docker Bearer Token Relam&quot;" title="Lien direct vers Activez &quot;Docker Bearer Token Relam&quot;">​</a></h3>
<p><code>Docker Bearer Token Realm</code> est une mesure de sécurité nécessaire pour gérer l&#x27;authentification des pulls anonymes.</p>
<ol>
<li>
<p>Cliquez sur &quot;Security &gt; Realms&quot;.</p>
</li>
<li>
<p>Ajoutez le &quot;Docker Bearer Token Realm&quot;.</p>
</li>
<li>
<p>Cliquez sur &quot;Save&quot;.</p>
<p><img decoding="async" loading="lazy" alt="image-20240106221518161" src="/assets/images/image-20240106221518161-c515df13f8348f64ef10e76e5536e165.png" width="1091" height="580" class="img_ev3q"></p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="créez-un-registre-docker-hub-proxy">Créez un registre docker hub proxy<a href="#créez-un-registre-docker-hub-proxy" class="hash-link" aria-label="Lien direct vers Créez un registre docker hub proxy" title="Lien direct vers Créez un registre docker hub proxy">​</a></h3>
<ol>
<li>Cliquez sur &quot;Repositories&quot;.</li>
<li>Cliquez sur &quot;Create Repository&quot; et sélectionnez &quot;docker (proxy)&quot;.</li>
<li>Donnez-lui un nom, exemple &quot;docker-hub&quot;</li>
<li>Cochez &quot;HTTP&quot; et attribuez-lui le port 8082 (c&#x27;est le port que nous avons choisi pour le registre public).</li>
<li>Cochez &quot;Allow anonymous docker pull&quot;.</li>
<li>Sous Proxy &gt; Remote Storage, saisissez cette URL : <a href="https://registry-1.docker.io/" target="_blank" rel="noopener noreferrer">https://registry-1.docker.io</a></li>
<li>Sous Docker Index, sélectionnez &quot;Use Docker Hub&quot;.</li>
<li>Sous Storage &gt; Blob Store, choisissez le Blob Store que vous avez créé précédemment (&quot;docker-hub&quot;).</li>
<li>Cliquez sur &quot;Create Repository&quot;.</li>
</ol>
<p>Voilà, vous avez créé un registre docker hub de type proxy !</p>
<p><img decoding="async" loading="lazy" alt="image-20240106221918648" src="/assets/images/image-20240106221918648-db75020512e9dd087977073743ae3c26.png" width="1287" height="209" class="img_ev3q"></p>
<p>Maintenant, il est temps de tester tout cela. Vous allez donc tester un pull d&#x27;une image docker depuis le docker hub proxy :</p>
<p>Avec Docker Hub, si vous souhaitez récupérer une image du serveur <code>nginx</code>, par exemple, vous pouvez le faire avec la commande <code>docker pull nginx</code>. Maintenant, pour passer par le proxy Docker Hub que vous avez créé, lancez la commande <code>docker pull prod.local:5002/nginx</code> dans votre terminal :</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@masterserver:/home/mossaabfr# docker pull prod.local:5002/nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Using default tag: latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">latest: Pulling from nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">af107e978371: Pull complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">336ba1f05c3e: Pull complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">8c37d2ff6efa: Pull complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">51d6357098de: Pull complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">782f1ecce57d: Pull complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5e99d351b073: Pull complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">7b73345df136: Pull complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Digest: sha256:2bdc49f2f8ae8d8dc50ed00f2ee56d00385c6f8bc8a8b320d0a294d9e3b49026</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Status: Downloaded newer image for prod.local:5002/nginx:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prod.local:5002/nginx:latest</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Petit rappel : le port <code>5002</code> est celui qui a été mappé avec le port <code>8082</code> sur lequel nous avons configuré le registre public.</p>
<p>Depuis le bouton &quot;Browse&quot;, vous pouvez accéder à votre proxy Docker Hub, et vous constaterez que l&#x27;image <strong>nginx</strong> a bien été enregistrée par Nexus. La prochaine fois que vous effectuerez un pull depuis Nexus, il fournira directement l&#x27;image depuis le <strong>cache</strong>, sans avoir besoin de faire appel au Docker Hub public.</p>
<p><img decoding="async" loading="lazy" alt="image-20240106223523578" src="/assets/images/image-20240106223523578-91cc1e7021661a63c112e2700294bc99.png" width="787" height="331" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="créez-un-registre-docker-privé">Créez un registre docker privé<a href="#créez-un-registre-docker-privé" class="hash-link" aria-label="Lien direct vers Créez un registre docker privé" title="Lien direct vers Créez un registre docker privé">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="créez-un-stockage-blob-pour-le-registre-privé-1">Créez un stockage blob pour le registre privé<a href="#créez-un-stockage-blob-pour-le-registre-privé-1" class="hash-link" aria-label="Lien direct vers Créez un stockage blob pour le registre privé" title="Lien direct vers Créez un stockage blob pour le registre privé">​</a></h3>
<p>De la même manière que pour le registre public, vous savez maintenant comment faire. Créez un stockage blob, nommé par exemple &quot;docker-private&quot;, que vous allez utiliser pour stocker les images privées.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="créez-un-registre-privé-docker-hosted">Créez un registre privé (docker-hosted)<a href="#créez-un-registre-privé-docker-hosted" class="hash-link" aria-label="Lien direct vers Créez un registre privé (docker-hosted)" title="Lien direct vers Créez un registre privé (docker-hosted)">​</a></h3>
<ol>
<li>Cliquez sur &quot;Repositories&quot;.</li>
<li>Cliquez sur &quot;Create Repository&quot; et sélectionnez &quot;docker (hosted)&quot;.</li>
<li>Donnez-lui un nom, exemple &quot;docker-private&quot;</li>
<li>Cochez &quot;HTTP&quot; et attribuez-lui le port 8083 (c&#x27;est le port que nous avons choisi pour le registre privé).</li>
<li>Sous Docker Index, sélectionnez &quot;Use Docker Hub&quot;.</li>
<li>Sous Storage &gt; Blob Store, choisissez le Blob Store que vous avez créé précédemment (&quot;docker-private&quot;).</li>
<li>Cliquez sur &quot;Create Repository&quot;.</li>
</ol>
<p>Voilà, vous avez maintenant créé votre registre docker privé !</p>
<p><img decoding="async" loading="lazy" alt="image-20240107021614047" src="/assets/images/image-20240107021614047-1afdef801a26e2613d6cc6ffe9ec4262.png" width="1198" height="239" class="img_ev3q"></p>
<p>Pour tester notre registre Docker privé, nous allons créer une image de notre application Spring Boot et la pousser vers le registre privé.</p>
<p>Vous avez créé un proxy Docker Hub, profitez-en ! Modifiez votre Dockerfile pour effectuer le pull depuis le registre Nexus. Ajoutez son URL <code>prod.local:5002/</code> devant le nom de l&#x27;image, de la même manière que pour la commande <code>docker pull</code></p>
<div class="language-dockerfile codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FROM prod.local:5002/amazoncorretto:17-alpine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY target/*.jar /opt/app/devops-project-samples.jar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPOSE 7070</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENTRYPOINT [&quot;java&quot;,&quot;-jar&quot;,&quot;/opt/app/devops-project-samples.jar&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Quand vous construisez une image Docker et que vous voulez la pousser vers un registre privé, son nom doit être préfixé par l&#x27;URL de ce dernier.</p>
<p>Depuis la racine de votre projet, exécuter la commande suivante pour faire le build de l&#x27;image :</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> docker build -t prod.local:5003/devops-project-samples:latest .</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Vérifiez que votre image a bien été créée :</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PS E:\workspace\maven-projects\devops-project-samples&gt; docker images</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REPOSITORY                               TAG                             IMAGE ID       CREATED         SIZE  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prod.local:5003/devops-project-samples   latest                          9b8294df572b   2 minutes ago   309MB </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Pour effectuer un push de l&#x27;image, similaire à Docker Hub, vous devez vous authentifier. Vous pouvez utiliser le compte admin pour tester, mais en production, il est recommandé de créer des utilisateurs avec des rôles spécifiques plutôt que d&#x27;utiliser directement le compte admin.</p>
<p>Commencez alors par exécuter la commande <code>docker login</code> pour vous connecter au registre privé :</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PS E:\workspace\maven-projects\devops-project-samples&gt; docker login prod.local:5003</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username: admin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Password:               </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Login Succeeded</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Poussez l&#x27;image docker de votre application avec la commande <code>docker push</code> :</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PS E:\workspace\maven-projects\devops-project-samples&gt; docker push prod.local:5003/devops-project-samples:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The push refers to repository [prod.local:5003/devops-project-samples]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">8a716a5d01c6: Pushed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">7e661cbcb912: Layer already exists</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">9fe9a137fd00: Layer already exists</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">latest: digest: sha256:2bcea3be4dc37856bfd0d90ad643c947bcf8c55c5ea3530ecdb12c75789cfea8 size: 953</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copier le code" title="Copier" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Vérifiez dans &quot;Browse&quot;  &gt; &quot;docker-private&quot; que votre image a bien été enregistrée !</p>
<p><img decoding="async" loading="lazy" alt="image-20240107024638141" src="/assets/images/image-20240107024638141-bd8c5242df544a496397adfac0f50983.png" width="724" height="302" class="img_ev3q"></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Pages de documentation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/devops/Conteneurisez l&#x27;application Spring Boot avec Docker"><div class="pagination-nav__sublabel">Précédent</div><div class="pagination-nav__label">Conteneurisez l&#x27;application Spring Boot avec Docker</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/devops/Utilisez Ansible pour automatiser le déploiement de votre application"><div class="pagination-nav__sublabel">Suivant</div><div class="pagination-nav__label">Utilisez Ansible pour automatiser le déploiement de votre application</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#installez-nexus-repository-manager" class="table-of-contents__link toc-highlight">Installez Nexus Repository Manager</a></li><li><a href="#configurez-docker-pour-accepter-les-registres-non-sécurisés" class="table-of-contents__link toc-highlight">Configurez docker pour accepter les registres non sécurisés</a></li><li><a href="#créez-un-docker-hub-proxy" class="table-of-contents__link toc-highlight">Créez un docker hub proxy</a><ul><li><a href="#créez-un-stockage-blob-pour-le-registre-privé" class="table-of-contents__link toc-highlight">Créez un stockage blob pour le registre privé</a></li><li><a href="#activez-docker-bearer-token-relam" class="table-of-contents__link toc-highlight">Activez &quot;Docker Bearer Token Relam&quot;</a></li><li><a href="#créez-un-registre-docker-hub-proxy" class="table-of-contents__link toc-highlight">Créez un registre docker hub proxy</a></li></ul></li><li><a href="#créez-un-registre-docker-privé" class="table-of-contents__link toc-highlight">Créez un registre docker privé</a><ul><li><a href="#créez-un-stockage-blob-pour-le-registre-privé-1" class="table-of-contents__link toc-highlight">Créez un stockage blob pour le registre privé</a></li><li><a href="#créez-un-registre-privé-docker-hosted" class="table-of-contents__link toc-highlight">Créez un registre privé (docker-hosted)</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/category/devops-cicd-pipeline">Articles</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/mossaab-frifita-17ba44138" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/MossaabFrifita" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Mossaab Frifita. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>